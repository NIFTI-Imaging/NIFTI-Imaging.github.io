<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>fslio.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.4 on Mon Dec 13 17:43:44 2004 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>fslio.h</h1><a href="fslio_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00005 <font class="comment">/*</font>
00006 <font class="comment">    fslio.h  (Input and output routines for images in FSL)</font>
00007 <font class="comment"></font>
00008 <font class="comment">    Mark Jenkinson</font>
00009 <font class="comment">    FMRIB Image Analysis Group</font>
00010 <font class="comment"></font>
00074 
00075 <font class="preprocessor">#if !defined(__FSLIO_H)</font>
00076 <font class="preprocessor"></font><font class="preprocessor">#define __FSLIO_H</font>
00077 <font class="preprocessor"></font>
00078 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00079 <font class="preprocessor">#include &lt;<a class="code" href="nifti1_io_h.html">nifti1_io.h</a>&gt;</font>
00080 <font class="preprocessor">#include &lt;znzlib.h&gt;</font>
00081 <font class="preprocessor">#include "dbh.h"</font>
00082 
00083 <font class="preprocessor">#ifdef __cplusplus</font>
00084 <font class="preprocessor"></font><font class="keyword">extern</font> <font class="stringliteral">"C"</font> {
00085 <font class="preprocessor">#endif</font>
00086 <font class="preprocessor"></font>
00087 
00088   <font class="comment">/*</font>
00089 <font class="comment">    Note that this library is similar to avwio but has changed in many ways.</font>
00090 <font class="comment">    It is almost fully backwards compatible, but not quite, as it cannot write</font>
00091 <font class="comment">    .nii.gz files using the old style functions.</font>
00092 <font class="comment"></font>
00093 <font class="comment">    Recommended ways of reading and writing images are:</font>
00094 <font class="comment"></font>
00095 <font class="comment">    Reading</font>
00096 <font class="comment">    -------</font>
00097 <font class="comment">      Use the FslOpen(), FslReadVolumes() and FslClose() functions.  e.g.</font>
00098 <font class="comment">        FSLIO *fslio;</font>
00099 <font class="comment">        void *buffer;</font>
00100 <font class="comment">        int nvols;</font>
00101 <font class="comment">        fslio = FslOpen("/some/path/name_of_file","rb");</font>
00102 <font class="comment">          ... can now access header info via the FslGet calls ...</font>
00103 <font class="comment">          ... allocate room for buffer ...</font>
00104 <font class="comment">        FslReadVolumes(fslio,buffer,nvols);</font>
00105 <font class="comment">          ... do something ...</font>
00106 <font class="comment">        FslClose(fslio);</font>
00107 <font class="comment"></font>
00108 <font class="comment"></font>
00109 <font class="comment">    Writing</font>
00110 <font class="comment">    -------</font>
00111 <font class="comment">      This is more complicated due to the nature of gzipped writing, which must be</font>
00112 <font class="comment">      done in the correct order, and for single files (*.nii.gz) this means that </font>
00113 <font class="comment">      the header information must be written before any image data.</font>
00114 <font class="comment"></font>
00115 <font class="comment">    (1)</font>
00116 <font class="comment">      The best method to use is almost backwards compatible, but requires </font>
00117 <font class="comment">      an FslWriteHeader() call:</font>
00118 <font class="comment"></font>
00119 <font class="comment">        FSLIO* fslio;</font>
00120 <font class="comment">        fslio = FslOpen("/some/path/name_of_file","wb");</font>
00121 <font class="comment">          ... set the appropriate header information using FslSet calls ...</font>
00122 <font class="comment">        FslWriteHeader(fslio);</font>
00123 <font class="comment">        </font>
00124 <font class="comment">          ... now can write one or more volumes at a time using </font>
00125 <font class="comment">              FslWriteVolumes(fslio,buffer,nvols) ...</font>
00126 <font class="comment"></font>
00127 <font class="comment">        FslClose(fslio); </font>
00128 <font class="comment"></font>
00129 <font class="comment">      This version is useful if your image data needs to be written from different blocks</font>
00130 <font class="comment">      of memory.</font>
00131 <font class="comment"></font>
00132 <font class="comment">    (2)</font>
00133 <font class="comment">      Another method is available, but which is discouraged, is:</font>
00134 <font class="comment">        FSLIO* fslio;</font>
00135 <font class="comment">        fslio = FslOpen("/some/path/name_of_file","wb");</font>
00136 <font class="comment">        </font>
00137 <font class="comment">          ... set some appropriate header information using FslSet calls ...</font>
00138 <font class="comment">          ... now can write one or more volumes at a time using </font>
00139 <font class="comment">              FslWriteVolumes(fslio,buffer,nvols) ...</font>
00140 <font class="comment">          ... set more appropriate header information using FslSet calls ...</font>
00141 <font class="comment"></font>
00142 <font class="comment">        FslClose(fslio);</font>
00143 <font class="comment"></font>
00144 <font class="comment">      WARNING: this cannot write .nii.gz files as the header information cannot be</font>
00145 <font class="comment">      written by FslClose() after the image data is written, which is how the previous</font>
00146 <font class="comment">      versions have worked.</font>
00147 <font class="comment">        </font>
00148 <font class="comment"></font>
00149 <font class="comment">   */</font>
00150 
00155 <font class="preprocessor">#define FSL_TYPE_ANALYZE         0</font>
00156 <font class="preprocessor"></font><font class="preprocessor">#define FSL_TYPE_NIFTI           1</font>
00157 <font class="preprocessor"></font><font class="preprocessor">#define FSL_TYPE_NIFTI_PAIR      2</font>
00158 <font class="preprocessor"></font><font class="preprocessor">#define FSL_TYPE_MINC            4</font>
00159 <font class="preprocessor"></font><font class="preprocessor">#define FSL_TYPE_ANALYZE_GZ    100</font>
00160 <font class="preprocessor"></font><font class="preprocessor">#define FSL_TYPE_NIFTI_GZ      101</font>
00161 <font class="preprocessor"></font><font class="preprocessor">#define FSL_TYPE_NIFTI_PAIR_GZ 102</font>
00162 <font class="preprocessor"></font><font class="preprocessor">#define FSL_TYPE_MINC_GZ       104</font>
00163 <font class="preprocessor"></font><font class="comment">/* @} */</font>
00164 
00165 <font class="preprocessor">#define FSL_RADIOLOGICAL        -1</font>
00166 <font class="preprocessor"></font><font class="preprocessor">#define FSL_NEUROLOGICAL         1</font>
00167 <font class="preprocessor"></font>
00168 
00174 <font class="keyword">typedef</font> <font class="keyword">struct </font>
00175 <font class="keyword"></font>{
00176   znzFile fileptr;
00177   <a class="code" href="struct_nifti_image.html">nifti_image</a> *niftiptr;
00178 <font class="preprocessor">#ifdef USE_MINC</font>
00179 <font class="preprocessor"></font>  minc_image *mincptr;
00180 <font class="preprocessor">#else</font>
00181 <font class="preprocessor"></font>  <font class="keywordtype">void</font> *mincptr;
00182 <font class="preprocessor">#endif</font>
00183 <font class="preprocessor"></font>  <font class="keywordtype">int</font> file_mode;
00184   <font class="keywordtype">int</font> write_mode;
00185   <font class="keywordtype">int</font> written_hdr;
00186 } <a class="code" href="struct_FSLIO.html">FSLIO</a>;
00187 
00188 
00189   <font class="comment">/* basic file i/o commands */</font>
00190 
00191 <a class="code" href="struct_FSLIO.html">FSLIO</a> *FslOpen(<font class="keyword">const</font> <font class="keywordtype">char</font> *filename, <font class="keyword">const</font> <font class="keywordtype">char</font> *opts);
00192 <a class="code" href="struct_FSLIO.html">FSLIO</a> *FslXOpen(<font class="keyword">const</font> <font class="keywordtype">char</font> *filename, <font class="keyword">const</font> <font class="keywordtype">char</font> *opts, <font class="keywordtype">int</font> filetype);
00193 <font class="keywordtype">int</font> FslSeekVolume(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, size_t vols);
00194 <font class="keywordtype">int</font> FslClose(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio);
00195 
00196   <font class="comment">/* basic read and write commands */</font>
00197 
00198 <font class="keywordtype">void</font>* FslReadAllVolumes(<a class="code" href="struct_FSLIO.html">FSLIO</a>* fslio, <font class="keywordtype">char</font>* filename);
00199 <font class="keywordtype">void</font>  FslWriteAllVolumes(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keyword">const</font> <font class="keywordtype">void</font> *buffer);
00200 
00201 size_t FslReadVolumes(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">void</font> *buffer, size_t nvols);
00202 size_t FslWriteVolumes(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keyword">const</font> <font class="keywordtype">void</font> *buffer, size_t nvols);
00203 
00204 <font class="keywordtype">void</font>   FslWriteHeader(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio);
00205 
00206   <font class="comment">/* support functions for file names and types */</font>
00207 
00208 <font class="keywordtype">int</font>   FslFileExists(<font class="keyword">const</font> <font class="keywordtype">char</font> *filename);
00209 <font class="keywordtype">char</font> *FslMakeBaseName(<font class="keyword">const</font> <font class="keywordtype">char</font> *fname);
00210 <font class="keywordtype">int</font>   FslCheckForMultipleFileNames(<font class="keyword">const</font> <font class="keywordtype">char</font>* filename);
00211 <font class="keywordtype">int</font>   FslGetEnvOutputType();
00212 
00213 <font class="keywordtype">void</font>  FslSetIgnoreMFQ(<font class="keywordtype">int</font> flag);
00214 <font class="keywordtype">int</font>   FslGetIgnoreMFQ();
00215 <font class="keywordtype">void</font>  FslSetOverrideOutputType(<font class="keywordtype">int</font> type);
00216 <font class="keywordtype">int</font>   FslGetOverrideOutputType();
00217 
00218 
00219 <font class="keywordtype">int</font>  FslGetFileType(<font class="keyword">const</font> <a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio);
00220 <font class="keywordtype">void</font> FslSetFileType(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">int</font> filetype);
00221 <font class="keywordtype">int</font>  FslIsSingleFileType(<font class="keywordtype">int</font> filetype);
00222 <font class="keywordtype">int</font>  FslIsCompressedFileType(<font class="keywordtype">int</font> filetype);
00223 <font class="keywordtype">int</font>  FslBaseFileType(<font class="keywordtype">int</font> filetype);
00224 <font class="keywordtype">char</font>* FslFileTypeString(<font class="keywordtype">int</font> filetype);
00225 
00226 <font class="keywordtype">int</font>  FslGetWriteMode(<font class="keyword">const</font> <a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio);
00227 <font class="keywordtype">void</font> FslSetWriteMode(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">int</font> mode);
00228 
00229 <font class="keywordtype">void</font> <a class="code" href="fslio_h.html#a46">AvwSwapHeader</a>(<font class="keyword">struct</font> dsr *avw);
00230 <font class="keywordtype">int</font>  FslReadRawHeader(<font class="keywordtype">void</font> *buffer, <font class="keyword">const</font> <font class="keywordtype">char</font>* filename);
00231 
00232 
00233   <font class="comment">/* simple creation and clone/copy operations */</font>
00234 
00235 <a class="code" href="struct_FSLIO.html">FSLIO</a> *<a class="code" href="fslio_c.html#a19">FslInit</a>();
00236 <font class="keywordtype">void</font>   FslInitHeader(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> t, 
00237                    size_t x, size_t y, size_t z, size_t v,
00238                    <font class="keywordtype">float</font> vx, <font class="keywordtype">float</font> vy, <font class="keywordtype">float</font> vz, <font class="keywordtype">float</font> tr,
00239                    size_t dim,
00240                    <font class="keyword">const</font> <font class="keywordtype">char</font>* units);
00241 <font class="keywordtype">void</font>   FslCloneHeader(<a class="code" href="struct_FSLIO.html">FSLIO</a> *dest, <font class="keyword">const</font> <a class="code" href="struct_FSLIO.html">FSLIO</a> *src);
00242 
00243 
00244   <font class="comment">/* get and set routines for properties */</font>
00245 
00246 size_t FslGetVolSize(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio);
00247 
00248 <font class="keywordtype">void</font> FslSetDim(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> x, <font class="keywordtype">short</font> y, <font class="keywordtype">short</font> z, <font class="keywordtype">short</font> v);
00249 <font class="keywordtype">void</font> FslGetDim(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> *x, <font class="keywordtype">short</font> *y, <font class="keywordtype">short</font> *z, <font class="keywordtype">short</font> *v);
00250 <font class="keywordtype">void</font> FslSetDimensionality(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, size_t dim);
00251 <font class="keywordtype">void</font> FslGetDimensionality(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, size_t *dim);
00252 <font class="keywordtype">void</font> FslSetVoxDim(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">float</font> x, <font class="keywordtype">float</font> y, <font class="keywordtype">float</font> z, <font class="keywordtype">float</font> tr);
00253 <font class="keywordtype">void</font> FslGetVoxDim(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">float</font> *x, <font class="keywordtype">float</font> *y, <font class="keywordtype">float</font> *z, <font class="keywordtype">float</font> *tr);
00254 <font class="keywordtype">void</font> FslGetCalMinMax(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">float</font> *min, <font class="keywordtype">float</font> *max);
00255 <font class="keywordtype">void</font> FslSetCalMinMax(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">float</font>  min, <font class="keywordtype">float</font>  max);
00256 <font class="keywordtype">void</font> FslGetAuxFile(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio,<font class="keywordtype">char</font> *aux_file);
00257 <font class="keywordtype">void</font> FslSetAuxFile(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio,<font class="keyword">const</font> <font class="keywordtype">char</font> *aux_file);
00258 <font class="keywordtype">void</font> FslSetTimeUnits(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keyword">const</font> <font class="keywordtype">char</font> *units);
00259 <font class="keywordtype">void</font> FslGetTimeUnits(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">char</font> *units);
00260 <font class="keywordtype">void</font> FslSetDataType(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> t);
00261 size_t FslGetDataType(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> *t);
00262 <font class="keywordtype">int</font>    FslGetIntensityScaling(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">float</font> *slope, <font class="keywordtype">float</font> *intercept);
00263 <font class="keywordtype">void</font>   FslSetIntent(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> intent_code, <font class="keywordtype">float</font> p1, <font class="keywordtype">float</font> p2, <font class="keywordtype">float</font> p3);
00264 <font class="keywordtype">short</font>  FslGetIntent(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> *intent_code, <font class="keywordtype">float</font> *p1, <font class="keywordtype">float</font> *p2,
00265                     <font class="keywordtype">float</font> *p3);
00266 
00267 
00268 <font class="keywordtype">short</font> FslGetStdXform(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, mat44 *stdmat);
00269 <font class="keywordtype">void</font>  FslSetStdXform(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> sform_code, mat44 stdmat);
00270 <font class="keywordtype">void</font>  FslGetMMCoord(mat44 stdmat, <font class="keywordtype">float</font> voxx, <font class="keywordtype">float</font> voxy, <font class="keywordtype">float</font> voxz, 
00271                     <font class="keywordtype">float</font> *mmx, <font class="keywordtype">float</font> *mmy, <font class="keywordtype">float</font> *mmz);
00272 
00273 <font class="keywordtype">void</font>  FslGetVoxCoord(mat44 stdmat, <font class="keywordtype">float</font> mmx, <font class="keywordtype">float</font> mmy, <font class="keywordtype">float</font> mmz, 
00274                      <font class="keywordtype">float</font> *voxx, <font class="keywordtype">float</font> *voxy, <font class="keywordtype">float</font> *voxz); 
00275 <font class="keywordtype">short</font> FslGetRigidXform(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, mat44 *rigidmat);
00276 <font class="keywordtype">void</font>  FslSetRigidXform(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> qform_code, mat44 rigidmat);
00277 <font class="keywordtype">int</font>   FslGetLeftRightOrder(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio);
00278 
00279   <font class="comment">/* these two functions are deprecated with the nifti/analyze support */</font>
00280   <font class="comment">/* please do all spatial coordinate origins via the Std and Rigid Xforms */</font>
00281 <font class="keywordtype">void</font>  FslSetAnalyzeSform(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keyword">const</font> <font class="keywordtype">short</font> *orig, 
00282                          <font class="keywordtype">float</font> dx, <font class="keywordtype">float</font> dy, <font class="keywordtype">float</font> dz);
00283 <font class="keywordtype">void</font>  FslGetAnalyzeOrigin(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">short</font> orig[5]);
00284 
00285   <font class="comment">/* other read and write commands */</font>
00286 
00287 size_t FslReadSliceSeries(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">void</font> *buffer,<font class="keywordtype">short</font> slice, size_t nvols);
00288 size_t FslReadRowSeries(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">void</font> *buffer, <font class="keywordtype">short</font> row, <font class="keywordtype">short</font> slice, size_t nvols);
00289 size_t FslReadTimeSeries(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio, <font class="keywordtype">void</font> *buffer, <font class="keywordtype">short</font> xVox, <font class="keywordtype">short</font> yVox, <font class="keywordtype">short</font> zVox, size_t nvols);
00290 
00291   <font class="comment">/* miscellaneous helper stuff */</font>
00292 
00293 mat33 mat44_to_mat33(mat44 x);
00294 
00295 
00296 <font class="preprocessor">#ifdef __cplusplus</font>
00297 <font class="preprocessor"></font>}
00298 <font class="preprocessor">#endif</font>
00299 <font class="preprocessor"></font>
00300 <font class="preprocessor">#endif</font>
00301 <font class="preprocessor"></font>
00302 
00303 <font class="comment">/* added by KF pending discussion w/ Mark */</font>
00304 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>   THIS_UINT8; 
00305 <font class="keyword">typedef</font> <font class="keywordtype">char</font>            THIS_INT8;
00306 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">short</font>  THIS_UINT16;
00307 <font class="keyword">typedef</font> <font class="keywordtype">short</font>           THIS_INT16;
00308 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>    THIS_UINT32;
00309 <font class="keyword">typedef</font> <font class="keywordtype">int</font>             THIS_INT32;
00310 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font>   THIS_UINT64;
00311 <font class="keyword">typedef</font> <font class="keywordtype">long</font>            THIS_INT64;
00312 <font class="keyword">typedef</font> <font class="keywordtype">float</font>           THIS_FLOAT32;
00313 <font class="keyword">typedef</font> <font class="keywordtype">double</font>          THIS_FLOAT64;
00314 
00315 <font class="keywordtype">double</font> ****<a class="code" href="fslio_h.html#a82">d4matrix</a>(<font class="keywordtype">int</font> th, <font class="keywordtype">int</font> zh,  <font class="keywordtype">int</font> yh, <font class="keywordtype">int</font> xh);
00316 <font class="keywordtype">double</font> ****FslGetBufferAsScaledDouble(<a class="code" href="struct_FSLIO.html">FSLIO</a> *fslio);
</div></pre><hr><address><small>Generated at Mon Dec 13 17:43:44 2004 for nifti1_io by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.4 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
