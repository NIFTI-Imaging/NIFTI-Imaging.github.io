<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>nifti1.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.4 on Mon Dec 13 17:43:44 2004 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>nifti1.h</h1><a href="nifti1_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00005 <font class="preprocessor">#ifndef _NIFTI_HEADER_</font>
00006 <font class="preprocessor"></font><font class="preprocessor">#define _NIFTI_HEADER_</font>
00007 <font class="preprocessor"></font>
00008 <font class="comment">/*****************************************************************************</font>
00009 <font class="comment">      ** This file defines the "NIFTI-1" header format.               **</font>
00010 <font class="comment">      ** It is derived from 2 meetings at the NIH (31 Mar 2003 and    **</font>
00011 <font class="comment">      ** 02 Sep 2003) of the Data Format Working Group (DFWG),        **</font>
00012 <font class="comment">      ** chartered by the NIfTI (Neuroimaging Informatics Technology  **</font>
00013 <font class="comment">      ** Initiative) at the National Institutes of Health (NIH).      **</font>
00014 <font class="comment">      **--------------------------------------------------------------**</font>
00015 <font class="comment">      ** Neither the National Institutes of Health (NIH), the DFWG,   **</font>
00016 <font class="comment">      ** nor any of the members or employees of these institutions    **</font>
00017 <font class="comment">      ** imply any warranty of usefulness of this material for any    **</font>
00018 <font class="comment">      ** purpose, and do not assume any liability for damages,        **</font>
00019 <font class="comment">      ** incidental or otherwise, caused by any use of this document. **</font>
00020 <font class="comment">      ** If these conditions are not acceptable, do not use this!     **</font>
00021 <font class="comment">      **--------------------------------------------------------------**</font>
00022 <font class="comment">      ** Author:   Robert W Cox (NIMH, Bethesda)                      **</font>
00023 <font class="comment">      ** Advisors: John Ashburner (FIL, London),                      **</font>
00024 <font class="comment">      **           Stephen Smith (FMRIB, Oxford),                     **</font>
00025 <font class="comment">      **           Mark Jenkinson (FMRIB, Oxford)                     **</font>
00026 <font class="comment">******************************************************************************/</font>
00027 
00028 
00029 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00030 <font class="comment">/* Note that the ANALYZE 7.5 file header (dbh.h) is</font>
00031 <font class="comment">         (c) Copyright 1986-1995</font>
00032 <font class="comment">         Biomedical Imaging Resource</font>
00033 <font class="comment">         Mayo Foundation</font>
00034 <font class="comment">   Incorporation of components of dbh.h are by permission of the</font>
00035 <font class="comment">   Mayo Foundation.</font>
00036 <font class="comment"></font>
00037 <font class="comment">   Changes from the ANALYZE 7.5 file header in this file are released to the</font>
00038 <font class="comment">   public domain, including the functional comments and any amusing asides.</font>
00039 <font class="comment">-----------------------------------------------------------------------------*/</font>
00040 
00041 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00107 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00108 <font class="comment">/* HEADER STRUCT DECLARATION:</font>
00109 <font class="comment">   -------------------------</font>
00110 <font class="comment">   In the comments below for each field, only NIFTI-1 specific requirements</font>
00111 <font class="comment">   or changes from the ANALYZE 7.5 format are described.  For convenience,</font>
00112 <font class="comment">   the 348 byte header is described as a single struct, rather than as the</font>
00113 <font class="comment">   ANALYZE 7.5 group of 3 substructs.</font>
00114 <font class="comment"></font>
00115 <font class="comment">   Further comments about the interpretation of various elements of this</font>
00116 <font class="comment">   header are after the data type definition itself.  Fields that are</font>
00117 <font class="comment">   marked as ++UNUSED++ have no particular interpretation in this standard.</font>
00118 <font class="comment">   (Also see the UNUSED FIELDS comment section, far below.)</font>
00119 <font class="comment"></font>
00120 <font class="comment">   The presumption below is that the various C types have particular sizes:</font>
00121 <font class="comment">     sizeof(int) = sizeof(float) = 4 ;  sizeof(short) = 2</font>
00122 <font class="comment">-----------------------------------------------------------------------------*/</font>
00123 
00124 <font class="comment">/*=================*/</font>
00125 <font class="preprocessor">#ifdef  __cplusplus</font>
00126 <font class="preprocessor"></font><font class="keyword">extern</font> <font class="stringliteral">"C"</font> {
00127 <font class="preprocessor">#endif</font>
00128 <font class="preprocessor"></font><font class="comment">/*=================*/</font>
00129 
00133                         <font class="comment">/*************************/</font>  <font class="comment">/************************/</font>
00134 <font class="keyword">struct </font><a class="code" href="struct_nifti_1_header.html">nifti_1_header</a> { <font class="comment">/* NIFTI-1 usage         */</font>  <font class="comment">/* ANALYZE 7.5 field(s) */</font>
00135                         <font class="comment">/*************************/</font>  <font class="comment">/************************/</font>
00136 
00137                                            <font class="comment">/*--- was header_key substruct ---*/</font>
<a name="l00138"></a><a class="code" href="struct_nifti_1_header.html#m0">00138</a>  <font class="keywordtype">int</font>   sizeof_hdr;      <font class="comment">/* int sizeof_hdr;      */</font>
<a name="l00139"></a><a class="code" href="struct_nifti_1_header.html#m1">00139</a>  <font class="keywordtype">char</font>  data_type[10];   <font class="comment">/* char data_type[10];  */</font>
<a name="l00140"></a><a class="code" href="struct_nifti_1_header.html#m2">00140</a>  <font class="keywordtype">char</font>  db_name[18];     <font class="comment">/* char db_name[18];    */</font>
<a name="l00141"></a><a class="code" href="struct_nifti_1_header.html#m3">00141</a>  <font class="keywordtype">int</font>   extents;         <font class="comment">/* int extents;         */</font>
<a name="l00142"></a><a class="code" href="struct_nifti_1_header.html#m4">00142</a>  <font class="keywordtype">short</font> session_error;   <font class="comment">/* short session_error; */</font>
<a name="l00143"></a><a class="code" href="struct_nifti_1_header.html#m5">00143</a>  <font class="keywordtype">char</font>  regular;         <font class="comment">/* char regular;        */</font>
<a name="l00144"></a><a class="code" href="struct_nifti_1_header.html#m6">00144</a>  <font class="keywordtype">char</font>  dim_info;        <font class="comment">/* char hkey_un0;       */</font>
00145 
00146                                       <font class="comment">/*--- was image_dimension substruct ---*/</font>
<a name="l00147"></a><a class="code" href="struct_nifti_1_header.html#m7">00147</a>  <font class="keywordtype">short</font> dim[8];          <font class="comment">/* short dim[8];        */</font>
<a name="l00148"></a><a class="code" href="struct_nifti_1_header.html#m8">00148</a>  <font class="keywordtype">float</font> intent_p1 ;      <font class="comment">/* short unused8;       */</font>
00149                                                      <font class="comment">/* short unused9;       */</font>
<a name="l00150"></a><a class="code" href="struct_nifti_1_header.html#m9">00150</a>  <font class="keywordtype">float</font> intent_p2 ;      <font class="comment">/* short unused10;      */</font>
00151                                                      <font class="comment">/* short unused11;      */</font>
<a name="l00152"></a><a class="code" href="struct_nifti_1_header.html#m10">00152</a>  <font class="keywordtype">float</font> intent_p3 ;      <font class="comment">/* short unused12;      */</font>
00153                                                      <font class="comment">/* short unused13;      */</font>
<a name="l00154"></a><a class="code" href="struct_nifti_1_header.html#m11">00154</a>  <font class="keywordtype">short</font> intent_code ;    <font class="comment">/* short unused14;      */</font>
<a name="l00155"></a><a class="code" href="struct_nifti_1_header.html#m12">00155</a>  <font class="keywordtype">short</font> datatype;        <font class="comment">/* short datatype;      */</font>
<a name="l00156"></a><a class="code" href="struct_nifti_1_header.html#m13">00156</a>  <font class="keywordtype">short</font> bitpix;          <font class="comment">/* short bitpix;        */</font>
<a name="l00157"></a><a class="code" href="struct_nifti_1_header.html#m14">00157</a>  <font class="keywordtype">short</font> slice_start;     <font class="comment">/* short dim_un0;       */</font>
<a name="l00158"></a><a class="code" href="struct_nifti_1_header.html#m15">00158</a>  <font class="keywordtype">float</font> pixdim[8];       <font class="comment">/* float pixdim[8];     */</font>
<a name="l00159"></a><a class="code" href="struct_nifti_1_header.html#m16">00159</a>  <font class="keywordtype">float</font> vox_offset;      <font class="comment">/* float vox_offset;    */</font>
<a name="l00160"></a><a class="code" href="struct_nifti_1_header.html#m17">00160</a>  <font class="keywordtype">float</font> scl_slope ;      <font class="comment">/* float funused1;      */</font>
<a name="l00161"></a><a class="code" href="struct_nifti_1_header.html#m18">00161</a>  <font class="keywordtype">float</font> scl_inter ;      <font class="comment">/* float funused2;      */</font>
<a name="l00162"></a><a class="code" href="struct_nifti_1_header.html#m19">00162</a>  <font class="keywordtype">short</font> slice_end;       <font class="comment">/* float funused3;      */</font>
<a name="l00163"></a><a class="code" href="struct_nifti_1_header.html#m20">00163</a>  <font class="keywordtype">char</font>  slice_code ;   
<a name="l00164"></a><a class="code" href="struct_nifti_1_header.html#m21">00164</a>  <font class="keywordtype">char</font>  xyzt_units ;   
<a name="l00165"></a><a class="code" href="struct_nifti_1_header.html#m22">00165</a>  <font class="keywordtype">float</font> cal_max;         <font class="comment">/* float cal_max;       */</font>
<a name="l00166"></a><a class="code" href="struct_nifti_1_header.html#m23">00166</a>  <font class="keywordtype">float</font> cal_min;         <font class="comment">/* float cal_min;       */</font>
<a name="l00167"></a><a class="code" href="struct_nifti_1_header.html#m24">00167</a>  <font class="keywordtype">float</font> slice_duration;  <font class="comment">/* float compressed;    */</font>
<a name="l00168"></a><a class="code" href="struct_nifti_1_header.html#m25">00168</a>  <font class="keywordtype">float</font> toffset;         <font class="comment">/* float verified;      */</font>
<a name="l00169"></a><a class="code" href="struct_nifti_1_header.html#m26">00169</a>  <font class="keywordtype">int</font>   glmax;           <font class="comment">/* int glmax;           */</font>
<a name="l00170"></a><a class="code" href="struct_nifti_1_header.html#m27">00170</a>  <font class="keywordtype">int</font>   glmin;           <font class="comment">/* int glmin;           */</font>
00171 
00172                                          <font class="comment">/*--- was data_history substruct ---*/</font>
<a name="l00173"></a><a class="code" href="struct_nifti_1_header.html#m28">00173</a>  <font class="keywordtype">char</font>  descrip[80];     <font class="comment">/* char descrip[80];    */</font>
<a name="l00174"></a><a class="code" href="struct_nifti_1_header.html#m29">00174</a>  <font class="keywordtype">char</font>  aux_file[24];    <font class="comment">/* char aux_file[24];   */</font>
00175 
<a name="l00176"></a><a class="code" href="struct_nifti_1_header.html#m30">00176</a>  <font class="keywordtype">short</font> qform_code ;     <font class="comment">/*-- all ANALYZE 7.5 ---*/</font>
<a name="l00177"></a><a class="code" href="struct_nifti_1_header.html#m31">00177</a>  <font class="keywordtype">short</font> sform_code ;     <font class="comment">/*   fields below here  */</font>
00178                                                      <font class="comment">/*   are replaced       */</font>
<a name="l00179"></a><a class="code" href="struct_nifti_1_header.html#m32">00179</a>  <font class="keywordtype">float</font> quatern_b ;    
<a name="l00180"></a><a class="code" href="struct_nifti_1_header.html#m33">00180</a>  <font class="keywordtype">float</font> quatern_c ;    
<a name="l00181"></a><a class="code" href="struct_nifti_1_header.html#m34">00181</a>  <font class="keywordtype">float</font> quatern_d ;    
<a name="l00182"></a><a class="code" href="struct_nifti_1_header.html#m35">00182</a>  <font class="keywordtype">float</font> qoffset_x ;    
<a name="l00183"></a><a class="code" href="struct_nifti_1_header.html#m36">00183</a>  <font class="keywordtype">float</font> qoffset_y ;    
<a name="l00184"></a><a class="code" href="struct_nifti_1_header.html#m37">00184</a>  <font class="keywordtype">float</font> qoffset_z ;    
<a name="l00186"></a><a class="code" href="struct_nifti_1_header.html#m38">00186</a>  <font class="keywordtype">float</font> srow_x[4] ;    
<a name="l00187"></a><a class="code" href="struct_nifti_1_header.html#m39">00187</a>  <font class="keywordtype">float</font> srow_y[4] ;    
<a name="l00188"></a><a class="code" href="struct_nifti_1_header.html#m40">00188</a>  <font class="keywordtype">float</font> srow_z[4] ;    
<a name="l00190"></a><a class="code" href="struct_nifti_1_header.html#m41">00190</a>  <font class="keywordtype">char</font> intent_name[16];
<a name="l00192"></a><a class="code" href="struct_nifti_1_header.html#m42">00192</a>  <font class="keywordtype">char</font> magic[4] ;      
00194 } ;                   <font class="comment">/**** 348 bytes total ****/</font>
00195 
00196 <font class="keyword">typedef</font> <font class="keyword">struct </font><a class="code" href="struct_nifti_1_header.html">nifti_1_header</a> <a class="code" href="struct_nifti_1_header.html">nifti_1_header</a> ;
00197 
00198 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00199 <font class="comment">/* DATA DIMENSIONALITY (as in ANALYZE 7.5):</font>
00200 <font class="comment">   ---------------------------------------</font>
00201 <font class="comment">     dim[0] = number of dimensions;</font>
00202 <font class="comment">              - if dim[0] is outside range 1..7, then the header information</font>
00203 <font class="comment">                needs to be byte swapped appropriately</font>
00204 <font class="comment">              - ANALYZE supports dim[0] up to 7, but NIFTI-1 reserves</font>
00205 <font class="comment">                dimensions 1,2,3 for space (x,y,z), 4 for time (t), and</font>
00206 <font class="comment">                5,6,7 for anything else needed.</font>
00207 <font class="comment"></font>
00208 <font class="comment">     dim[i] = length of dimension #i, for i=1..dim[0]  (must be positive)</font>
00209 <font class="comment">              - also see the discussion of intent_code, far below</font>
00210 <font class="comment"></font>
00211 <font class="comment">     pixdim[i] = voxel width along dimension #i, i=1..dim[0] (positive)</font>
00212 <font class="comment">                 - cf. ORIENTATION section below for use of pixdim[0]</font>
00213 <font class="comment">                 - the units of pixdim can be specified with the xyzt_units</font>
00214 <font class="comment">                   field (also described far below).</font>
00215 <font class="comment"></font>
00216 <font class="comment">   Number of bits per voxel value is in bitpix, which MUST correspond with</font>
00217 <font class="comment">   the datatype field.  The total number of bytes in the image data is</font>
00218 <font class="comment">     dim[1] * ... * dim[dim[0]] * bitpix / 8</font>
00219 <font class="comment"></font>
00220 <font class="comment">   In NIFTI-1 files, dimensions 1,2,3 are for space, dimension 4 is for time,</font>
00221 <font class="comment">   and dimension 5 is for storing multiple values at each spatiotemporal</font>
00222 <font class="comment">   voxel.  Some examples:</font>
00223 <font class="comment">     - A typical whole-brain FMRI experiment's time series:</font>
00224 <font class="comment">        - dim[0] = 4</font>
00225 <font class="comment">        - dim[1] = 64   pixdim[1] = 3.75 xyzt_units =  NIFTI_UNITS_MM</font>
00226 <font class="comment">        - dim[2] = 64   pixdim[2] = 3.75             | NIFTI_UNITS_SEC</font>
00227 <font class="comment">        - dim[3] = 20   pixdim[3] = 5.0</font>
00228 <font class="comment">        - dim[4] = 120  pixdim[4] = 2.0</font>
00229 <font class="comment">     - A typical T1-weighted anatomical volume:</font>
00230 <font class="comment">        - dim[0] = 3</font>
00231 <font class="comment">        - dim[1] = 256  pixdim[1] = 1.0  xyzt_units = NIFTI_UNITS_MM</font>
00232 <font class="comment">        - dim[2] = 256  pixdim[2] = 1.0</font>
00233 <font class="comment">        - dim[3] = 128  pixdim[3] = 1.1</font>
00234 <font class="comment">     - A single slice EPI time series:</font>
00235 <font class="comment">        - dim[0] = 4</font>
00236 <font class="comment">        - dim[1] = 64   pixdim[1] = 3.75 xyzt_units =  NIFTI_UNITS_MM</font>
00237 <font class="comment">        - dim[2] = 64   pixdim[2] = 3.75             | NIFTI_UNITS_SEC</font>
00238 <font class="comment">        - dim[3] = 1    pixdim[3] = 5.0</font>
00239 <font class="comment">        - dim[4] = 1200 pixdim[4] = 0.2</font>
00240 <font class="comment">     - A 3-vector stored at each point in a 3D volume:</font>
00241 <font class="comment">        - dim[0] = 5</font>
00242 <font class="comment">        - dim[1] = 256  pixdim[1] = 1.0  xyzt_units = NIFTI_UNITS_MM</font>
00243 <font class="comment">        - dim[2] = 256  pixdim[2] = 1.0</font>
00244 <font class="comment">        - dim[3] = 128  pixdim[3] = 1.1</font>
00245 <font class="comment">        - dim[4] = 1    pixdim[4] = 0.0</font>
00246 <font class="comment">        - dim[5] = 3                     intent_code = NIFTI_INTENT_VECTOR</font>
00247 <font class="comment">     - A single time series with a 3x3 matrix at each point:</font>
00248 <font class="comment">        - dim[0] = 5</font>
00249 <font class="comment">        - dim[1] = 1                     xyzt_units = NIFTI_UNITS_SEC</font>
00250 <font class="comment">        - dim[2] = 1</font>
00251 <font class="comment">        - dim[3] = 1</font>
00252 <font class="comment">        - dim[4] = 1200 pixdim[4] = 0.2</font>
00253 <font class="comment">        - dim[5] = 9                     intent_code = NIFTI_INTENT_GENMATRIX</font>
00254 <font class="comment">        - intent_p1 = intent_p2 = 3.0    (indicates matrix dimensions)</font>
00255 <font class="comment">-----------------------------------------------------------------------------*/</font>
00256 
00257 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00258 <font class="comment">/* DATA STORAGE:</font>
00259 <font class="comment">   ------------</font>
00260 <font class="comment">   If the magic field is "n+1", then the voxel data is stored in the</font>
00261 <font class="comment">   same file as the header.  In this case, the voxel data starts at offset</font>
00262 <font class="comment">   (int)vox_offset into the header file.  Thus, vox_offset=348.0 means that</font>
00263 <font class="comment">   the data starts immediately after the NIFTI-1 header.  If vox_offset is</font>
00264 <font class="comment">   greater than 348, the NIFTI-1 format does not say anything about the</font>
00265 <font class="comment">   contents of the dataset file between the end of the header and the</font>
00266 <font class="comment">   start of the data.</font>
00267 <font class="comment"></font>
00268 <font class="comment">   FILES:</font>
00269 <font class="comment">   -----</font>
00270 <font class="comment">   If the magic field is "ni1", then the voxel data is stored in the</font>
00271 <font class="comment">   associated ".img" file, starting at offset 0 (i.e., vox_offset is not</font>
00272 <font class="comment">   used in this case, and should be set to 0.0).</font>
00273 <font class="comment"></font>
00274 <font class="comment">   When storing NIFTI-1 datasets in pairs of files, it is customary to name</font>
00275 <font class="comment">   the files in the pattern "name.hdr" and "name.img", as in ANALYZE 7.5.</font>
00276 <font class="comment">   When storing in a single file ("n+1"), the file name should be in</font>
00277 <font class="comment">   the form "name.nii" (the ".nft" and ".nif" suffixes are already taken;</font>
00278 <font class="comment">   cf. http://www.icdatamaster.com/n.html ).</font>
00279 <font class="comment"></font>
00280 <font class="comment">   BYTE ORDERING:</font>
00281 <font class="comment">   -------------</font>
00282 <font class="comment">   The byte order of the data arrays is presumed to be the same as the byte</font>
00283 <font class="comment">   order of the header (which is determined by examining dim[0]).</font>
00284 <font class="comment"></font>
00285 <font class="comment">   Floating point types are presumed to be stored in IEEE-754 format.</font>
00286 <font class="comment">-----------------------------------------------------------------------------*/</font>
00287 
00288 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00289 <font class="comment">/* DATA SCALING:</font>
00290 <font class="comment">   ------------</font>
00291 <font class="comment">   If the scl_slope field is nonzero, then each voxel value in the dataset</font>
00292 <font class="comment">   should be scaled as</font>
00293 <font class="comment">      y = scl_slope * x + scl_inter</font>
00294 <font class="comment">   where x = voxel value stored</font>
00295 <font class="comment">         y = "true" voxel value</font>
00296 <font class="comment">   Normally, we would expect this scaling to be used to store "true" floating</font>
00297 <font class="comment">   values in a smaller integer datatype, but that is not required.  That is,</font>
00298 <font class="comment">   it is legal to use scaling even if the datatype is a float type (crazy,</font>
00299 <font class="comment">   perhaps, but legal).</font>
00300 <font class="comment">    - However, the scaling is to be ignored if datatype is DT_RGB24.</font>
00301 <font class="comment">    - If datatype is a complex type, then the scaling is to be</font>
00302 <font class="comment">      applied to both the real and imaginary parts.</font>
00303 <font class="comment"></font>
00304 <font class="comment">   The cal_min and cal_max fields (if nonzero) are used for mapping (possibly</font>
00305 <font class="comment">   scaled) dataset values to display colors:</font>
00306 <font class="comment">    - Minimum display intensity (black) corresponds to dataset value cal_min.</font>
00307 <font class="comment">    - Maximum display intensity (white) corresponds to dataset value cal_max.</font>
00308 <font class="comment">    - Dataset values below cal_min should display as black also, and values</font>
00309 <font class="comment">      above cal_max as white.</font>
00310 <font class="comment">    - Colors "black" and "white", of course, may refer to any scalar display</font>
00311 <font class="comment">      scheme (e.g., a color lookup table specified via aux_file).</font>
00312 <font class="comment">    - cal_min and cal_max only make sense when applied to scalar-valued</font>
00313 <font class="comment">      datasets (i.e., dim[0] &lt; 5 or dim[5] = 1).</font>
00314 <font class="comment">-----------------------------------------------------------------------------*/</font>
00315 
00316 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00317 <font class="comment">/* TYPE OF DATA (acceptable values for datatype field):</font>
00318 <font class="comment">   ---------------------------------------------------</font>
00319 <font class="comment">   Values of datatype smaller than 256 are ANALYZE 7.5 compatible.</font>
00320 <font class="comment">   Larger values are NIFTI-1 additions.  These are all multiples of 256, so</font>
00321 <font class="comment">   that no bits below position 8 are set in datatype.  But there is no need</font>
00322 <font class="comment">   to use only powers-of-2, as the original ANALYZE 7.5 datatype codes do.</font>
00323 <font class="comment"></font>
00324 <font class="comment">   The additional codes are intended to include a complete list of basic</font>
00325 <font class="comment">   scalar types, including signed and unsigned integers from 8 to 64 bits,</font>
00326 <font class="comment">   floats from 32 to 128 bits, and complex (float pairs) from 64 to 256 bits.</font>
00327 <font class="comment"></font>
00328 <font class="comment">   Note that most programs will support only a few of these datatypes!</font>
00329 <font class="comment">   A NIFTI-1 program should fail gracefully (e.g., print a warning message)</font>
00330 <font class="comment">   when it encounters a dataset with a type it doesn't like.</font>
00331 <font class="comment">-----------------------------------------------------------------------------*/</font>
00332 
00333 <font class="preprocessor">#undef DT_UNKNOWN  </font><font class="comment">/* defined in dirent.h on some Unix systems */</font>
00334 
00335                             <font class="comment">/*--- the original ANALYZE 7.5 type codes ---*/</font>
00340 <font class="preprocessor">#define DT_NONE                    0</font>
00341 <font class="preprocessor"></font><font class="preprocessor">#define DT_UNKNOWN                 0     </font><font class="comment">/* what it says, dude           */</font>
00342 <font class="preprocessor">#define DT_BINARY                  1     </font><font class="comment">/* binary (1 bit/voxel)         */</font>
00343 <font class="preprocessor">#define DT_UNSIGNED_CHAR           2     </font><font class="comment">/* unsigned char (8 bits/voxel) */</font>
00344 <font class="preprocessor">#define DT_SIGNED_SHORT            4     </font><font class="comment">/* signed short (16 bits/voxel) */</font>
00345 <font class="preprocessor">#define DT_SIGNED_INT              8     </font><font class="comment">/* signed int (32 bits/voxel)   */</font>
00346 <font class="preprocessor">#define DT_FLOAT                  16     </font><font class="comment">/* float (32 bits/voxel)        */</font>
00347 <font class="preprocessor">#define DT_COMPLEX                32     </font><font class="comment">/* complex (64 bits/voxel)      */</font>
00348 <font class="preprocessor">#define DT_DOUBLE                 64     </font><font class="comment">/* double (64 bits/voxel)       */</font>
00349 <font class="preprocessor">#define DT_RGB                   128     </font><font class="comment">/* RGB triple (24 bits/voxel)   */</font>
00350 <font class="preprocessor">#define DT_ALL                   255     </font><font class="comment">/* not very useful (?)          */</font>
00351 
00352                             <font class="comment">/*----- another set of names for the same ---*/</font>
00353 <font class="preprocessor">#define DT_UINT8                   2</font>
00354 <font class="preprocessor"></font><font class="preprocessor">#define DT_INT16                   4</font>
00355 <font class="preprocessor"></font><font class="preprocessor">#define DT_INT32                   8</font>
00356 <font class="preprocessor"></font><font class="preprocessor">#define DT_FLOAT32                16</font>
00357 <font class="preprocessor"></font><font class="preprocessor">#define DT_COMPLEX64              32</font>
00358 <font class="preprocessor"></font><font class="preprocessor">#define DT_FLOAT64                64</font>
00359 <font class="preprocessor"></font><font class="preprocessor">#define DT_RGB24                 128</font>
00360 <font class="preprocessor"></font>
00361                             <font class="comment">/*------------------- new codes for NIFTI ---*/</font>
00362 <font class="preprocessor">#define DT_INT8                  256     </font><font class="comment">/* signed char (8 bits)         */</font>
00363 <font class="preprocessor">#define DT_UINT16                512     </font><font class="comment">/* unsigned short (16 bits)     */</font>
00364 <font class="preprocessor">#define DT_UINT32                768     </font><font class="comment">/* unsigned int (32 bits)       */</font>
00365 <font class="preprocessor">#define DT_INT64                1024     </font><font class="comment">/* long long (64 bits)          */</font>
00366 <font class="preprocessor">#define DT_UINT64               1280     </font><font class="comment">/* unsigned long long (64 bits) */</font>
00367 <font class="preprocessor">#define DT_FLOAT128             1536     </font><font class="comment">/* long double (128 bits)       */</font>
00368 <font class="preprocessor">#define DT_COMPLEX128           1792     </font><font class="comment">/* double pair (128 bits)       */</font>
00369 <font class="preprocessor">#define DT_COMPLEX256           2048     </font><font class="comment">/* long double pair (256 bits)  */</font>
00370 <font class="comment">/* @} */</font>
00371 
00372                             <font class="comment">/*------- aliases for all the above codes ---*/</font>
00373 
<a name="l00379"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a0">00379</a> <font class="preprocessor">#define NIFTI_TYPE_UINT8           2</font>
00380 <font class="preprocessor"></font>
<a name="l00381"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a1">00381</a> <font class="preprocessor">#define NIFTI_TYPE_INT16           4</font>
00382 <font class="preprocessor"></font>
<a name="l00383"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a2">00383</a> <font class="preprocessor">#define NIFTI_TYPE_INT32           8</font>
00384 <font class="preprocessor"></font>
<a name="l00385"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a3">00385</a> <font class="preprocessor">#define NIFTI_TYPE_FLOAT32        16</font>
00386 <font class="preprocessor"></font>
<a name="l00387"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a4">00387</a> <font class="preprocessor">#define NIFTI_TYPE_COMPLEX64      32</font>
00388 <font class="preprocessor"></font>
<a name="l00389"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a5">00389</a> <font class="preprocessor">#define NIFTI_TYPE_FLOAT64        64</font>
00390 <font class="preprocessor"></font>
<a name="l00391"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a6">00391</a> <font class="preprocessor">#define NIFTI_TYPE_RGB24         128</font>
00392 <font class="preprocessor"></font>
<a name="l00393"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a7">00393</a> <font class="preprocessor">#define NIFTI_TYPE_INT8          256</font>
00394 <font class="preprocessor"></font>
<a name="l00395"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a8">00395</a> <font class="preprocessor">#define NIFTI_TYPE_UINT16        512</font>
00396 <font class="preprocessor"></font>
<a name="l00397"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a9">00397</a> <font class="preprocessor">#define NIFTI_TYPE_UINT32        768</font>
00398 <font class="preprocessor"></font>
<a name="l00399"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a10">00399</a> <font class="preprocessor">#define NIFTI_TYPE_INT64        1024</font>
00400 <font class="preprocessor"></font>
<a name="l00401"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a11">00401</a> <font class="preprocessor">#define NIFTI_TYPE_UINT64       1280</font>
00402 <font class="preprocessor"></font>
<a name="l00403"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a12">00403</a> <font class="preprocessor">#define NIFTI_TYPE_FLOAT128     1536</font>
00404 <font class="preprocessor"></font>
<a name="l00405"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a13">00405</a> <font class="preprocessor">#define NIFTI_TYPE_COMPLEX128   1792</font>
00406 <font class="preprocessor"></font>
<a name="l00407"></a><a class="code" href="group_NIFTI1_DATATYPE_ALIASES.html#a14">00407</a> <font class="preprocessor">#define NIFTI_TYPE_COMPLEX256   2048</font>
00408 <font class="preprocessor"></font><font class="comment">/* @} */</font>
00409 
00410                      <font class="comment">/*-------- sample typedefs for complicated types ---*/</font>
00411 <font class="preprocessor">#if 0</font>
00412 <font class="preprocessor"></font><font class="keyword">typedef</font> <font class="keyword">struct </font>{ <font class="keywordtype">float</font>       r,i;     } complex_float ;
00413 <font class="keyword">typedef</font> <font class="keyword">struct </font>{ <font class="keywordtype">double</font>      r,i;     } complex_double ;
00414 <font class="keyword">typedef</font> <font class="keyword">struct </font>{ <font class="keywordtype">long</font> <font class="keywordtype">double</font> r,i;     } complex_longdouble ;
00415 <font class="keyword">typedef</font> <font class="keyword">struct </font>{ <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> r,g,b; } rgb_byte ;
00416 <font class="preprocessor">#endif</font>
00417 <font class="preprocessor"></font>
00418 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00419 <font class="comment">/* INTERPRETATION OF VOXEL DATA:</font>
00420 <font class="comment">   ----------------------------</font>
00421 <font class="comment">   The intent_code field can be used to indicate that the voxel data has</font>
00422 <font class="comment">   some particular meaning.  In particular, a large number of codes is</font>
00423 <font class="comment">   given to indicate that the the voxel data should be interpreted as</font>
00424 <font class="comment">   being drawn from a given probability distribution.</font>
00425 <font class="comment"></font>
00426 <font class="comment">   VECTOR-VALUED DATASETS:</font>
00427 <font class="comment">   ----------------------</font>
00428 <font class="comment">   The 5th dimension of the dataset, if present (i.e., dim[0]=5 and</font>
00429 <font class="comment">   dim[5] &gt; 1), contains multiple values (e.g., a vector) to be stored</font>
00430 <font class="comment">   at each spatiotemporal location.  For example, the header values</font>
00431 <font class="comment">    - dim[0] = 5</font>
00432 <font class="comment">    - dim[1] = 64</font>
00433 <font class="comment">    - dim[2] = 64</font>
00434 <font class="comment">    - dim[3] = 20</font>
00435 <font class="comment">    - dim[4] = 1     (indicates no time axis)</font>
00436 <font class="comment">    - dim[5] = 3</font>
00437 <font class="comment">    - datatype = DT_FLOAT</font>
00438 <font class="comment">    - intent_code = NIFTI_INTENT_VECTOR</font>
00439 <font class="comment">   mean that this dataset should be interpreted as a 3D volume (64x64x20),</font>
00440 <font class="comment">   with a 3-vector of floats defined at each point in the 3D grid.</font>
00441 <font class="comment"></font>
00442 <font class="comment">   A program reading a dataset with a 5th dimension may want to reformat</font>
00443 <font class="comment">   the image data to store each voxels' set of values together in a struct</font>
00444 <font class="comment">   or array.  This programming detail, however, is beyond the scope of the</font>
00445 <font class="comment">   NIFTI-1 file specification!  Uses of dimensions 6 and 7 are also not</font>
00446 <font class="comment">   specified here.</font>
00447 <font class="comment"></font>
00448 <font class="comment">   STATISTICAL PARAMETRIC DATASETS (i.e., SPMs):</font>
00449 <font class="comment">   --------------------------------------------</font>
00450 <font class="comment">   Values of intent_code from NIFTI_FIRST_STATCODE to NIFTI_LAST_STATCODE</font>
00451 <font class="comment">   (inclusive) indicate that the numbers in the dataset should be interpreted</font>
00452 <font class="comment">   as being drawn from a given distribution.  Most such distributions have</font>
00453 <font class="comment">   auxiliary parameters (e.g., NIFTI_INTENT_TTEST has 1 DOF parameter).</font>
00454 <font class="comment"></font>
00455 <font class="comment">   If the dataset DOES NOT have a 5th dimension, then the auxiliary parameters</font>
00456 <font class="comment">   are the same for each voxel, and are given in header fields intent_p1,</font>
00457 <font class="comment">   intent_p2, and intent_p3.</font>
00458 <font class="comment"></font>
00459 <font class="comment">   If the dataset DOES have a 5th dimension, then the auxiliary parameters</font>
00460 <font class="comment">   are different for each voxel.  For example, the header values</font>
00461 <font class="comment">    - dim[0] = 5</font>
00462 <font class="comment">    - dim[1] = 128</font>
00463 <font class="comment">    - dim[2] = 128</font>
00464 <font class="comment">    - dim[3] = 1      (indicates a single slice)</font>
00465 <font class="comment">    - dim[4] = 1      (indicates no time axis)</font>
00466 <font class="comment">    - dim[5] = 2</font>
00467 <font class="comment">    - datatype = DT_FLOAT</font>
00468 <font class="comment">    - intent_code = NIFTI_INTENT_TTEST</font>
00469 <font class="comment">   mean that this is a 2D dataset (128x128) of t-statistics, with the</font>
00470 <font class="comment">   t-statistic being in the first "plane" of data and the degrees-of-freedom</font>
00471 <font class="comment">   parameter being in the second "plane" of data.</font>
00472 <font class="comment"></font>
00473 <font class="comment">   If the dataset 5th dimension is used to store the voxel-wise statistical</font>
00474 <font class="comment">   parameters, then dim[5] must be 1 plus the number of parameters required</font>
00475 <font class="comment">   by that distribution (e.g., intent_code=NIFTI_INTENT_TTEST implies dim[5]</font>
00476 <font class="comment">   must be 2, as in the example just above).</font>
00477 <font class="comment"></font>
00478 <font class="comment">   Note: intent_code values 2..10 are compatible with AFNI 1.5x (which is</font>
00479 <font class="comment">   why there is no code with value=1, which is obsolescent in AFNI).</font>
00480 <font class="comment"></font>
00481 <font class="comment">   OTHER INTENTIONS:</font>
00482 <font class="comment">   ----------------</font>
00483 <font class="comment">   The purpose of the intent_* fields is to help interpret the values</font>
00484 <font class="comment">   stored in the dataset.  Some non-statistical values for intent_code</font>
00485 <font class="comment">   and conventions are provided for storing other complex data types.</font>
00486 <font class="comment"></font>
00487 <font class="comment">   The intent_name field provides space for a 15 character (plus 0 byte)</font>
00488 <font class="comment">   'name' string for the type of data stored. Examples:</font>
00489 <font class="comment">    - intent_code = NIFTI_INTENT_ESTIMATE; intent_name = "T1";</font>
00490 <font class="comment">       could be used to signify that the voxel values are estimates of the</font>
00491 <font class="comment">       NMR parameter T1.</font>
00492 <font class="comment">    - intent_code = NIFTI_INTENT_TTEST; intent_name = "House";</font>
00493 <font class="comment">       could be used to signify that the voxel values are t-statistics</font>
00494 <font class="comment">       for the significance of 'activation' response to a House stimulus.</font>
00495 <font class="comment">    - intent_code = NIFTI_INTENT_DISPVECT; intent_name = "ToMNI152";</font>
00496 <font class="comment">       could be used to signify that the voxel values are a displacement</font>
00497 <font class="comment">       vector that transforms each voxel (x,y,z) location to the</font>
00498 <font class="comment">       corresponding location in the MNI152 standard brain.</font>
00499 <font class="comment">    - intent_code = NIFTI_INTENT_SYMMATRIX; intent_name = "DTI";</font>
00500 <font class="comment">       could be used to signify that the voxel values comprise a diffusion</font>
00501 <font class="comment">       tensor image.</font>
00502 <font class="comment"></font>
00503 <font class="comment">   If no data name is implied or needed, intent_name[0] should be set to 0.</font>
00504 <font class="comment">-----------------------------------------------------------------------------*/</font>
00505 
<a name="l00508"></a><a class="code" href="nifti1_h.html#a41">00508</a> <font class="preprocessor">#define NIFTI_INTENT_NONE        0</font>
00509 <font class="preprocessor"></font>
00510     <font class="comment">/*-------- These codes are for probability distributions ---------------*/</font>
00511     <font class="comment">/* Most distributions have a number of parameters,</font>
00512 <font class="comment">       below denoted by p1, p2, and p3, and stored in</font>
00513 <font class="comment">        - intent_p1, intent_p2, intent_p3 if dataset doesn't have 5th dimension</font>
00514 <font class="comment">        - image data array                if dataset does have 5th dimension</font>
00515 <font class="comment"></font>
00516 <font class="comment">       Functions to compute with many of the distributions below can be found</font>
00517 <font class="comment">       in the CDF library from U Texas.</font>
00518 <font class="comment"></font>
00519 <font class="comment">       Formulas for and discussions of these distributions can be found in the</font>
00520 <font class="comment">       following books:</font>
00521 <font class="comment"></font>
00522 <font class="comment">        [U] Univariate Discrete Distributions,</font>
00523 <font class="comment">            NL Johnson, S Kotz, AW Kemp.</font>
00524 <font class="comment"></font>
00525 <font class="comment">        [C1] Continuous Univariate Distributions, vol. 1,</font>
00526 <font class="comment">             NL Johnson, S Kotz, N Balakrishnan.</font>
00527 <font class="comment"></font>
00528 <font class="comment">        [C2] Continuous Univariate Distributions, vol. 2,</font>
00529 <font class="comment">             NL Johnson, S Kotz, N Balakrishnan.                            */</font>
00530     <font class="comment">/*----------------------------------------------------------------------*/</font>
00531 
00540 <font class="preprocessor">#define NIFTI_INTENT_CORREL      2</font>
00541 <font class="preprocessor"></font>
<a name="l00544"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a1">00544</a> <font class="preprocessor">#define NIFTI_INTENT_TTEST       3</font>
00545 <font class="preprocessor"></font>
<a name="l00549"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a2">00549</a> <font class="preprocessor">#define NIFTI_INTENT_FTEST       4</font>
00550 <font class="preprocessor"></font>
<a name="l00553"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a3">00553</a> <font class="preprocessor">#define NIFTI_INTENT_ZSCORE      5</font>
00554 <font class="preprocessor"></font>
<a name="l00558"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a4">00558</a> <font class="preprocessor">#define NIFTI_INTENT_CHISQ       6</font>
00559 <font class="preprocessor"></font>
<a name="l00563"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a5">00563</a> <font class="preprocessor">#define NIFTI_INTENT_BETA        7</font>
00564 <font class="preprocessor"></font>
<a name="l00569"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a6">00569</a> <font class="preprocessor">#define NIFTI_INTENT_BINOM       8</font>
00570 <font class="preprocessor"></font>
<a name="l00575"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a7">00575</a> <font class="preprocessor">#define NIFTI_INTENT_GAMMA       9</font>
00576 <font class="preprocessor"></font>
<a name="l00580"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a8">00580</a> <font class="preprocessor">#define NIFTI_INTENT_POISSON    10</font>
00581 <font class="preprocessor"></font>
<a name="l00585"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a9">00585</a> <font class="preprocessor">#define NIFTI_INTENT_NORMAL     11</font>
00586 <font class="preprocessor"></font>
<a name="l00591"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a10">00591</a> <font class="preprocessor">#define NIFTI_INTENT_FTEST_NONC 12</font>
00592 <font class="preprocessor"></font>
<a name="l00596"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a11">00596</a> <font class="preprocessor">#define NIFTI_INTENT_CHISQ_NONC 13</font>
00597 <font class="preprocessor"></font>
<a name="l00602"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a12">00602</a> <font class="preprocessor">#define NIFTI_INTENT_LOGISTIC   14</font>
00603 <font class="preprocessor"></font>
<a name="l00608"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a13">00608</a> <font class="preprocessor">#define NIFTI_INTENT_LAPLACE    15</font>
00609 <font class="preprocessor"></font>
<a name="l00612"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a14">00612</a> <font class="preprocessor">#define NIFTI_INTENT_UNIFORM    16</font>
00613 <font class="preprocessor"></font>
<a name="l00617"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a15">00617</a> <font class="preprocessor">#define NIFTI_INTENT_TTEST_NONC 17</font>
00618 <font class="preprocessor"></font>
<a name="l00624"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a16">00624</a> <font class="preprocessor">#define NIFTI_INTENT_WEIBULL    18</font>
00625 <font class="preprocessor"></font>
<a name="l00632"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a17">00632</a> <font class="preprocessor">#define NIFTI_INTENT_CHI        19</font>
00633 <font class="preprocessor"></font>
<a name="l00639"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a18">00639</a> <font class="preprocessor">#define NIFTI_INTENT_INVGAUSS   20</font>
00640 <font class="preprocessor"></font>
<a name="l00645"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a19">00645</a> <font class="preprocessor">#define NIFTI_INTENT_EXTVAL     21</font>
00646 <font class="preprocessor"></font>
<a name="l00649"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a20">00649</a> <font class="preprocessor">#define NIFTI_INTENT_PVAL       22</font>
00650 <font class="preprocessor"></font>
<a name="l00653"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a21">00653</a> <font class="preprocessor">#define NIFTI_INTENT_LOGPVAL       23</font>
00654 <font class="preprocessor"></font>
<a name="l00657"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a22">00657</a> <font class="preprocessor">#define NIFTI_INTENT_LOG10PVAL       24</font>
00658 <font class="preprocessor"></font>
<a name="l00661"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a23">00661</a> <font class="preprocessor">#define NIFTI_FIRST_STATCODE     2</font>
00662 <font class="preprocessor"></font>
<a name="l00665"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a24">00665</a> <font class="preprocessor">#define NIFTI_LAST_STATCODE     24</font>
00666 <font class="preprocessor"></font>
00667  <font class="comment">/*---------- these values for intent_code aren't for statistics ----------*/</font>
00668 
<a name="l00673"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a25">00673</a> <font class="preprocessor">#define NIFTI_INTENT_ESTIMATE  1001</font>
00674 <font class="preprocessor"></font>
<a name="l00679"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a26">00679</a> <font class="preprocessor">#define NIFTI_INTENT_LABEL     1002</font>
00680 <font class="preprocessor"></font>
<a name="l00684"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a27">00684</a> <font class="preprocessor">#define NIFTI_INTENT_NEURONAME 1003</font>
00685 <font class="preprocessor"></font>
<a name="l00698"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a28">00698</a> <font class="preprocessor">#define NIFTI_INTENT_GENMATRIX 1004</font>
00699 <font class="preprocessor"></font>
<a name="l00711"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a29">00711</a> <font class="preprocessor">#define NIFTI_INTENT_SYMMATRIX 1005</font>
00712 <font class="preprocessor"></font>
<a name="l00720"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a30">00720</a> <font class="preprocessor">#define NIFTI_INTENT_DISPVECT  1006   </font><font class="comment">/* specifically for displacements */</font>
00721 <font class="preprocessor">#define NIFTI_INTENT_VECTOR    1007   </font><font class="comment">/* for any other type of vector */</font>
00722 
<a name="l00734"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a32">00734</a> <font class="preprocessor">#define NIFTI_INTENT_POINTSET  1008</font>
00735 <font class="preprocessor"></font>
<a name="l00747"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a33">00747</a> <font class="preprocessor">#define NIFTI_INTENT_TRIANGLE  1009</font>
00748 <font class="preprocessor"></font>
<a name="l00756"></a><a class="code" href="group_NIFTI1_INTENT_CODES.html#a34">00756</a> <font class="preprocessor">#define NIFTI_INTENT_QUATERNION 1010</font>
00757 <font class="preprocessor"></font>
00758   <font class="comment">/* Dimensionless value - no params - although, as in _ESTIMATE </font>
00759 <font class="comment">      the name of the parameter may be stored in intent_name.     */</font>
00760 
00761 <font class="preprocessor">#define NIFTI_INTENT_DIMLESS  1011</font>
00762 <font class="preprocessor"></font><font class="comment">/* @} */</font>
00763 
00764 
00765 
00766 <font class="comment">/*---------------------------------------------------------------------------*/</font>
00767 <font class="comment">/* 3D IMAGE (VOLUME) ORIENTATION AND LOCATION IN SPACE:</font>
00768 <font class="comment">   ---------------------------------------------------</font>
00769 <font class="comment">   There are 3 different methods by which continuous coordinates can</font>
00770 <font class="comment">   attached to voxels.  The discussion below emphasizes 3D volumes, and</font>
00771 <font class="comment">   the continuous coordinates are referred to as (x,y,z).  The voxel</font>
00772 <font class="comment">   index coordinates (i.e., the array indexes) are referred to as (i,j,k),</font>
00773 <font class="comment">   with valid ranges:</font>
00774 <font class="comment">     i = 0 .. dim[1]-1</font>
00775 <font class="comment">     j = 0 .. dim[2]-1  (if dim[0] &gt;= 2)</font>
00776 <font class="comment">     k = 0 .. dim[3]-1  (if dim[0] &gt;= 3)</font>
00777 <font class="comment">   The (x,y,z) coordinates refer to the CENTER of a voxel.  In methods</font>
00778 <font class="comment">   2 and 3, the (x,y,z) axes refer to a subject-based coordinate system,</font>
00779 <font class="comment">   with</font>
00780 <font class="comment">     +x = Right  +y = Anterior  +z = Superior.</font>
00781 <font class="comment">   This is a right-handed coordinate system.  However, the exact direction</font>
00782 <font class="comment">   these axes point with respect to the subject depends on qform_code</font>
00783 <font class="comment">   (Method 2) and sform_code (Method 3).</font>
00784 <font class="comment"></font>
00785 <font class="comment">   N.B.: The i index varies most rapidly, j index next, k index slowest.</font>
00786 <font class="comment">    Thus, voxel (i,j,k) is stored starting at location</font>
00787 <font class="comment">      (i + j*dim[1] + k*dim[1]*dim[2]) * (bitpix/8)</font>
00788 <font class="comment">    into the dataset array.</font>
00789 <font class="comment"></font>
00790 <font class="comment">   N.B.: The ANALYZE 7.5 coordinate system is</font>
00791 <font class="comment">      +x = Left  +y = Anterior  +z = Superior</font>
00792 <font class="comment">    which is a left-handed coordinate system.  This backwardness is</font>
00793 <font class="comment">    too difficult to tolerate, so this NIFTI-1 standard specifies the</font>
00794 <font class="comment">    coordinate order which is most common in functional neuroimaging.</font>
00795 <font class="comment"></font>
00796 <font class="comment">   N.B.: The 3 methods below all give the locations of the voxel centers</font>
00797 <font class="comment">    in the (x,y,z) coordinate system.  In many cases, programs will wish</font>
00798 <font class="comment">    to display image data on some other grid.  In such a case, the program</font>
00799 <font class="comment">    will need to convert its desired (x,y,z) values into (i,j,k) values</font>
00800 <font class="comment">    in order to extract (or interpolate) the image data.  This operation</font>
00801 <font class="comment">    would be done with the inverse transformation to those described below.</font>
00802 <font class="comment"></font>
00803 <font class="comment">   N.B.: Method 2 uses a factor 'qfac' which is either -1 or 1; qfac is</font>
00804 <font class="comment">    stored in the otherwise unused pixdim[0].  If pixdim[0]=0.0 (which</font>
00805 <font class="comment">    should not occur), we take qfac=1.  Of course, pixdim[0] is only used</font>
00806 <font class="comment">    when reading a NIFTI-1 header, not when reading an ANALYZE 7.5 header.</font>
00807 <font class="comment"></font>
00808 <font class="comment">   N.B.: The units of (x,y,z) can be specified using the xyzt_units field.</font>
00809 <font class="comment"></font>
00810 <font class="comment">   METHOD 1 (the "old" way, used only when qform_code = 0):</font>
00811 <font class="comment">   -------------------------------------------------------</font>
00812 <font class="comment">   The coordinate mapping from (i,j,k) to (x,y,z) is the ANALYZE</font>
00813 <font class="comment">   7.5 way.  This is a simple scaling relationship:</font>
00814 <font class="comment"></font>
00815 <font class="comment">     x = pixdim[1] * i</font>
00816 <font class="comment">     y = pixdim[2] * j</font>
00817 <font class="comment">     z = pixdim[3] * k</font>
00818 <font class="comment"></font>
00819 <font class="comment">   No particular spatial orientation is attached to these (x,y,z)</font>
00820 <font class="comment">   coordinates.  (NIFTI-1 does not have the ANALYZE 7.5 orient field,</font>
00821 <font class="comment">   which is not general and is often not set properly.)  This method</font>
00822 <font class="comment">   is not recommended, and is present mainly for compatibility with</font>
00823 <font class="comment">   ANALYZE 7.5 files.</font>
00824 <font class="comment"></font>
00825 <font class="comment">   METHOD 2 (used when qform_code &gt; 0, which should be the "normal case):</font>
00826 <font class="comment">   ---------------------------------------------------------------------</font>
00827 <font class="comment">   The (x,y,z) coordinates are given by the pixdim[] scales, a rotation</font>
00828 <font class="comment">   matrix, and a shift.  This method is intended to represent</font>
00829 <font class="comment">   "scanner-anatomical" coordinates, which are often embedded in the</font>
00830 <font class="comment">   image header (e.g., DICOM fields (0020,0032), (0020,0037), (0028,0030),</font>
00831 <font class="comment">   and (0018,0050)), and represent the nominal orientation and location of</font>
00832 <font class="comment">   the data.  This method can also be used to represent "aligned"</font>
00833 <font class="comment">   coordinates, which would typically result from some post-acquisition</font>
00834 <font class="comment">   alignment of the volume to a standard orientation (e.g., the same</font>
00835 <font class="comment">   subject on another day, or a rigid rotation to true anatomical</font>
00836 <font class="comment">   orientation from the tilted position of the subject in the scanner).</font>
00837 <font class="comment">   The formula for (x,y,z) in terms of header parameters and (i,j,k) is:</font>
00838 <font class="comment"></font>
00839 <font class="comment">     [ x ]   [ R11 R12 R13 ] [        pixdim[1] * i ]   [ qoffset_x ]</font>
00840 <font class="comment">     [ y ] = [ R21 R22 R23 ] [        pixdim[2] * j ] + [ qoffset_y ]</font>
00841 <font class="comment">     [ z ]   [ R31 R32 R33 ] [ qfac * pixdim[3] * k ]   [ qoffset_z ]</font>
00842 <font class="comment"></font>
00843 <font class="comment">   The qoffset_* shifts are in the NIFTI-1 header.  Note that the center</font>
00844 <font class="comment">   of the (i,j,k)=(0,0,0) voxel (first value in the dataset array) is</font>
00845 <font class="comment">   just (x,y,z)=(qoffset_x,qoffset_y,qoffset_z).</font>
00846 <font class="comment"></font>
00847 <font class="comment">   The rotation matrix R is calculated from the quatern_* parameters.</font>
00848 <font class="comment">   This calculation is described below.</font>
00849 <font class="comment"></font>
00850 <font class="comment">   The scaling factor qfac is either 1 or -1.  The rotation matrix R</font>
00851 <font class="comment">   defined by the quaternion parameters is "proper" (has determinant 1).</font>
00852 <font class="comment">   This may not fit the needs of the data; for example, if the image</font>
00853 <font class="comment">   grid is</font>
00854 <font class="comment">     i increases from Left-to-Right</font>
00855 <font class="comment">     j increases from Anterior-to-Posterior</font>
00856 <font class="comment">     k increases from Inferior-to-Superior</font>
00857 <font class="comment">   Then (i,j,k) is a left-handed triple.  In this example, if qfac=1,</font>
00858 <font class="comment">   the R matrix would have to be</font>
00859 <font class="comment"></font>
00860 <font class="comment">     [  1   0   0 ]</font>
00861 <font class="comment">     [  0  -1   0 ]  which is "improper" (determinant = -1).</font>
00862 <font class="comment">     [  0   0   1 ]</font>
00863 <font class="comment"></font>
00864 <font class="comment">   If we set qfac=-1, then the R matrix would be</font>
00865 <font class="comment"></font>
00866 <font class="comment">     [  1   0   0 ]</font>
00867 <font class="comment">     [  0  -1   0 ]  which is proper.</font>
00868 <font class="comment">     [  0   0  -1 ]</font>
00869 <font class="comment"></font>
00870 <font class="comment">   This R matrix is represented by quaternion [a,b,c,d] = [0,1,0,0]</font>
00871 <font class="comment">   (which encodes a 180 degree rotation about the x-axis).</font>
00872 <font class="comment"></font>
00873 <font class="comment">   METHOD 3 (used when sform_code &gt; 0):</font>
00874 <font class="comment">   -----------------------------------</font>
00875 <font class="comment">   The (x,y,z) coordinates are given by a general affine transformation</font>
00876 <font class="comment">   of the (i,j,k) indexes:</font>
00877 <font class="comment"></font>
00878 <font class="comment">     x = srow_x[0] * i + srow_x[1] * j + srow_x[2] * k + srow_x[3]</font>
00879 <font class="comment">     y = srow_y[0] * i + srow_y[1] * j + srow_y[2] * k + srow_y[3]</font>
00880 <font class="comment">     z = srow_z[0] * i + srow_z[1] * j + srow_z[2] * k + srow_z[3]</font>
00881 <font class="comment"></font>
00882 <font class="comment">   The srow_* vectors are in the NIFTI_1 header.  Note that no use is</font>
00883 <font class="comment">   made of pixdim[] in this method.</font>
00884 <font class="comment"></font>
00885 <font class="comment">   WHY 3 METHODS?</font>
00886 <font class="comment">   --------------</font>
00887 <font class="comment">   Method 1 is provided only for backwards compatibility.  The intention</font>
00888 <font class="comment">   is that Method 2 (qform_code &gt; 0) represents the nominal voxel locations</font>
00889 <font class="comment">   as reported by the scanner, or as rotated to some fiducial orientation and</font>
00890 <font class="comment">   location.  Method 3, if present (sform_code &gt; 0), is to be used to give</font>
00891 <font class="comment">   the location of the voxels in some standard space.  The sform_code</font>
00892 <font class="comment">   indicates which standard space is present.  Both methods 2 and 3 can be</font>
00893 <font class="comment">   present, and be useful in different contexts (method 2 for displaying the</font>
00894 <font class="comment">   data on its original grid; method 3 for displaying it on a standard grid).</font>
00895 <font class="comment"></font>
00896 <font class="comment">   In this scheme, a dataset would originally be set up so that the</font>
00897 <font class="comment">   Method 2 coordinates represent what the scanner reported.  Later,</font>
00898 <font class="comment">   a registration to some standard space can be computed and inserted</font>
00899 <font class="comment">   in the header.  Image display software can use either transform,</font>
00900 <font class="comment">   depending on its purposes and needs.</font>
00901 <font class="comment"></font>
00902 <font class="comment">   In Method 2, the origin of coordinates would generally be whatever</font>
00903 <font class="comment">   the scanner origin is; for example, in MRI, (0,0,0) is the center</font>
00904 <font class="comment">   of the gradient coil.</font>
00905 <font class="comment"></font>
00906 <font class="comment">   In Method 3, the origin of coordinates would depend on the value</font>
00907 <font class="comment">   of sform_code; for example, for the Talairach coordinate system,</font>
00908 <font class="comment">   (0,0,0) corresponds to the Anterior Commissure.</font>
00909 <font class="comment"></font>
00910 <font class="comment">   QUATERNION REPRESENTATION OF ROTATION MATRIX (METHOD 2)</font>
00911 <font class="comment">   -------------------------------------------------------</font>
00912 <font class="comment">   The orientation of the (x,y,z) axes relative to the (i,j,k) axes</font>
00913 <font class="comment">   in 3D space is specified using a unit quaternion [a,b,c,d], where</font>
00914 <font class="comment">   a*a+b*b+c*c+d*d=1.  The (b,c,d) values are all that is needed, since</font>
00915 <font class="comment">   we require that a = sqrt(1.0-(b*b+c*c+d*d)) be nonnegative.  The (b,c,d)</font>
00916 <font class="comment">   values are stored in the (quatern_b,quatern_c,quatern_d) fields.</font>
00917 <font class="comment"></font>
00918 <font class="comment">   The quaternion representation is chosen for its compactness in</font>
00919 <font class="comment">   representing rotations. The (proper) 3x3 rotation matrix that</font>
00920 <font class="comment">   corresponds to [a,b,c,d] is</font>
00921 <font class="comment"></font>
00922 <font class="comment">         [ a*a+b*b-c*c-d*d   2*b*c-2*a*d       2*b*d+2*a*c     ]</font>
00923 <font class="comment">     R = [ 2*b*c+2*a*d       a*a+c*c-b*b-d*d   2*c*d-2*a*b     ]</font>
00924 <font class="comment">         [ 2*b*d-2*a*c       2*c*d+2*a*b       a*a+d*d-c*c-b*b ]</font>
00925 <font class="comment"></font>
00926 <font class="comment">         [ R11               R12               R13             ]</font>
00927 <font class="comment">       = [ R21               R22               R23             ]</font>
00928 <font class="comment">         [ R31               R32               R33             ]</font>
00929 <font class="comment"></font>
00930 <font class="comment">   If (p,q,r) is a unit 3-vector, then rotation of angle h about that</font>
00931 <font class="comment">   direction is represented by the quaternion</font>
00932 <font class="comment"></font>
00933 <font class="comment">     [a,b,c,d] = [cos(h/2), p*sin(h/2), q*sin(h/2), r*sin(h/2)].</font>
00934 <font class="comment"></font>
00935 <font class="comment">   Requiring a &gt;= 0 is equivalent to requiring -Pi &lt;= h &lt;= Pi.  (Note that</font>
00936 <font class="comment">   [-a,-b,-c,-d] represents the same rotation as [a,b,c,d]; there are 2</font>
00937 <font class="comment">   quaternions that can be used to represent a given rotation matrix R.)</font>
00938 <font class="comment">   To rotate a 3-vector (x,y,z) using quaternions, we compute the</font>
00939 <font class="comment">   quaternion product</font>
00940 <font class="comment"></font>
00941 <font class="comment">     [0,x',y',z'] = [a,b,c,d] * [0,x,y,z] * [a,-b,-c,-d]</font>
00942 <font class="comment"></font>
00943 <font class="comment">   which is equivalent to the matrix-vector multiply</font>
00944 <font class="comment"></font>
00945 <font class="comment">     [ x' ]     [ x ]</font>
00946 <font class="comment">     [ y' ] = R [ y ]   (equivalence depends on a*a+b*b+c*c+d*d=1)</font>
00947 <font class="comment">     [ z' ]     [ z ]</font>
00948 <font class="comment"></font>
00949 <font class="comment">   Multiplication of 2 quaternions is defined by the following:</font>
00950 <font class="comment"></font>
00951 <font class="comment">     [a,b,c,d] = a*1 + b*I + c*J + d*K</font>
00952 <font class="comment">     where</font>
00953 <font class="comment">       I*I = J*J = K*K = -1 (I,J,K are square roots of -1)</font>
00954 <font class="comment">       I*J =  K  J*K =  I  K*I =  J</font>
00955 <font class="comment">       J*I = -K  K*J = -I  I*K = -J  (not commutative!)</font>
00956 <font class="comment">     For example</font>
00957 <font class="comment">       [a,b,0,0] * [0,0,0,1] = [0,-b,0,a]</font>
00958 <font class="comment">     since this expands to</font>
00959 <font class="comment">       (a+b*I)*(K) = (a*K+b*I*K) = (a*K-b*J).</font>
00960 <font class="comment"></font>
00961 <font class="comment">   The above formula shows how to go from quaternion (b,c,d) to</font>
00962 <font class="comment">   rotation matrix and direction cosines.  Conversely, given R,</font>
00963 <font class="comment">   we can compute the fields for the NIFTI-1 header by</font>
00964 <font class="comment"></font>
00965 <font class="comment">     a = 0.5  * sqrt(1+R11+R22+R33)    (not stored)</font>
00966 <font class="comment">     b = 0.25 * (R32-R23) / a       =&gt; quatern_b</font>
00967 <font class="comment">     c = 0.25 * (R13-R31) / a       =&gt; quatern_c</font>
00968 <font class="comment">     d = 0.25 * (R21-R12) / a       =&gt; quatern_d</font>
00969 <font class="comment"></font>
00970 <font class="comment">   If a=0 (a 180 degree rotation), alternative formulas are needed.</font>
00971 <font class="comment">   See the nifti1_io.c function mat44_to_quatern() for an implementation</font>
00972 <font class="comment">   of the various cases in converting R to [a,b,c,d].</font>
00973 <font class="comment"></font>
00974 <font class="comment">   Note that R-transpose (= R-inverse) would lead to the quaternion</font>
00975 <font class="comment">   [a,-b,-c,-d].</font>
00976 <font class="comment"></font>
00977 <font class="comment">   The choice to specify the qoffset_x (etc.) values in the final</font>
00978 <font class="comment">   coordinate system is partly to make it easy to convert DICOM images to</font>
00979 <font class="comment">   this format.  The DICOM attribute "Image Position (Patient)" (0020,0032)</font>
00980 <font class="comment">   stores the (Xd,Yd,Zd) coordinates of the center of the first voxel.</font>
00981 <font class="comment">   Here, (Xd,Yd,Zd) refer to DICOM coordinates, and Xd=-x, Yd=-y, Zd=z,</font>
00982 <font class="comment">   where (x,y,z) refers to the NIFTI coordinate system discussed above.</font>
00983 <font class="comment">   (i.e., DICOM +Xd is Left, +Yd is Posterior, +Zd is Superior,</font>
00984 <font class="comment">        whereas +x is Right, +y is Anterior  , +z is Superior. )</font>
00985 <font class="comment">   Thus, if the (0020,0032) DICOM attribute is extracted into (px,py,pz), then</font>
00986 <font class="comment">     qoffset_x = -px   qoffset_y = -py   qoffset_z = pz</font>
00987 <font class="comment">   is a reasonable setting when qform_code=NIFTI_XFORM_SCANNER_ANAT.</font>
00988 <font class="comment"></font>
00989 <font class="comment">   That is, DICOM's coordinate system is 180 degrees rotated about the z-axis</font>
00990 <font class="comment">   from the neuroscience/NIFTI coordinate system.  To transform between DICOM</font>
00991 <font class="comment">   and NIFTI, you just have to negate the x- and y-coordinates.</font>
00992 <font class="comment"></font>
00993 <font class="comment">   The DICOM attribute (0020,0037) "Image Orientation (Patient)" gives the</font>
00994 <font class="comment">   orientation of the x- and y-axes of the image data in terms of 2 3-vectors.</font>
00995 <font class="comment">   The first vector is a unit vector along the x-axis, and the second is</font>
00996 <font class="comment">   along the y-axis.  If the (0020,0037) attribute is extracted into the</font>
00997 <font class="comment">   value (xa,xb,xc,ya,yb,yc), then the first two columns of the R matrix</font>
00998 <font class="comment">   would be</font>
00999 <font class="comment">              [ -xa  -ya ]</font>
01000 <font class="comment">              [ -xb  -yb ]</font>
01001 <font class="comment">              [  xc   yc ]</font>
01002 <font class="comment">   The negations are because DICOM's x- and y-axes are reversed relative</font>
01003 <font class="comment">   to NIFTI's.  The third column of the R matrix gives the direction of</font>
01004 <font class="comment">   displacement (relative to the subject) along the slice-wise direction.</font>
01005 <font class="comment">   This orientation is not encoded in the DICOM standard in a simple way;</font>
01006 <font class="comment">   DICOM is mostly concerned with 2D images.  The third column of R will be</font>
01007 <font class="comment">   either the cross-product of the first 2 columns or its negative.  It is</font>
01008 <font class="comment">   possible to infer the sign of the 3rd column by examining the coordinates</font>
01009 <font class="comment">   in DICOM attribute (0020,0032) "Image Position (Patient)" for successive</font>
01010 <font class="comment">   slices.  However, this method occasionally fails for reasons that I</font>
01011 <font class="comment">   (RW Cox) do not understand.</font>
01012 <font class="comment">-----------------------------------------------------------------------------*/</font>
01013 
01014    <font class="comment">/* [qs]form_code value:  */</font>      <font class="comment">/* x,y,z coordinate system refers to:    */</font>
01015    <font class="comment">/*-----------------------*/</font>      <font class="comment">/*---------------------------------------*/</font>
01016 
<a name="l01024"></a><a class="code" href="group_NIFTI1_XFORM_CODES.html#a0">01024</a> <font class="preprocessor">#define NIFTI_XFORM_UNKNOWN      0</font>
01025 <font class="preprocessor"></font>
<a name="l01028"></a><a class="code" href="group_NIFTI1_XFORM_CODES.html#a1">01028</a> <font class="preprocessor">#define NIFTI_XFORM_SCANNER_ANAT 1</font>
01029 <font class="preprocessor"></font>
<a name="l01033"></a><a class="code" href="group_NIFTI1_XFORM_CODES.html#a2">01033</a> <font class="preprocessor">#define NIFTI_XFORM_ALIGNED_ANAT 2</font>
01034 <font class="preprocessor"></font>
<a name="l01038"></a><a class="code" href="group_NIFTI1_XFORM_CODES.html#a3">01038</a> <font class="preprocessor">#define NIFTI_XFORM_TALAIRACH    3</font>
01039 <font class="preprocessor"></font>
<a name="l01042"></a><a class="code" href="group_NIFTI1_XFORM_CODES.html#a4">01042</a> <font class="preprocessor">#define NIFTI_XFORM_MNI_152      4</font>
01043 <font class="preprocessor"></font><font class="comment">/* @} */</font>
01044 
01045 <font class="comment">/*---------------------------------------------------------------------------*/</font>
01046 <font class="comment">/* UNITS OF SPATIAL AND TEMPORAL DIMENSIONS:</font>
01047 <font class="comment">   ----------------------------------------</font>
01048 <font class="comment">   The codes below can be used in xyzt_units to indicate the units of pixdim.</font>
01049 <font class="comment">   As noted earlier, dimensions 1,2,3 are for x,y,z; dimension 4 is for</font>
01050 <font class="comment">   time (t).</font>
01051 <font class="comment">    - If dim[4]=1 or dim[0] &lt; 4, there is no time axis.</font>
01052 <font class="comment">    - A single time series (no space) would be specified with</font>
01053 <font class="comment">      - dim[0] = 4 (for scalar data) or dim[0] = 5 (for vector data)</font>
01054 <font class="comment">      - dim[1] = dim[2] = dim[3] = 1</font>
01055 <font class="comment">      - dim[4] = number of time points</font>
01056 <font class="comment">      - pixdim[4] = time step</font>
01057 <font class="comment">      - xyzt_units indicates units of pixdim[4]</font>
01058 <font class="comment">      - dim[5] = number of values stored at each time point</font>
01059 <font class="comment"></font>
01060 <font class="comment">   Bits 0..2 of xyzt_units specify the units of pixdim[1..3]</font>
01061 <font class="comment">    (e.g., spatial units are values 1..7).</font>
01062 <font class="comment">   Bits 3..5 of xyzt_units specify the units of pixdim[4]</font>
01063 <font class="comment">    (e.g., temporal units are multiples of 8).</font>
01064 <font class="comment"></font>
01065 <font class="comment">   This compression of 2 distinct concepts into 1 byte is due to the</font>
01066 <font class="comment">   limited space available in the 348 byte ANALYZE 7.5 header.  The</font>
01067 <font class="comment">   macros XYZT_TO_SPACE and XYZT_TO_TIME can be used to mask off the</font>
01068 <font class="comment">   undesired bits from the xyzt_units fields, leaving "pure" space</font>
01069 <font class="comment">   and time codes.  Inversely, the macro SPACE_TIME_TO_XYZT can be</font>
01070 <font class="comment">   used to assemble a space code (0,1,2,...,7) with a time code</font>
01071 <font class="comment">   (0,8,16,32,...,56) into the combined value for xyzt_units.</font>
01072 <font class="comment"></font>
01073 <font class="comment">   Note that codes are provided to indicate the "time" axis units are</font>
01074 <font class="comment">   actually frequency in Hertz (_HZ), in part-per-million (_PPM)</font>
01075 <font class="comment">   or in radians-per-second (_RADS).</font>
01076 <font class="comment"></font>
01077 <font class="comment">   The toffset field can be used to indicate a nonzero start point for</font>
01078 <font class="comment">   the time axis.  That is, time point #m is at t=toffset+m*pixdim[4]</font>
01079 <font class="comment">   for m=0..dim[4]-1.</font>
01080 <font class="comment">-----------------------------------------------------------------------------*/</font>
<a name="l01088"></a><a class="code" href="group_NIFTI1_UNITS.html#a0">01088</a> <font class="preprocessor">#define NIFTI_UNITS_UNKNOWN 0</font>
01089 <font class="preprocessor"></font>
<a name="l01092"></a><a class="code" href="group_NIFTI1_UNITS.html#a1">01092</a> <font class="preprocessor">#define NIFTI_UNITS_METER   1</font>
01093 <font class="preprocessor"></font>
<a name="l01094"></a><a class="code" href="group_NIFTI1_UNITS.html#a2">01094</a> <font class="preprocessor">#define NIFTI_UNITS_MM      2</font>
01095 <font class="preprocessor"></font>
<a name="l01096"></a><a class="code" href="group_NIFTI1_UNITS.html#a3">01096</a> <font class="preprocessor">#define NIFTI_UNITS_MICRON  3</font>
01097 <font class="preprocessor"></font>
<a name="l01100"></a><a class="code" href="group_NIFTI1_UNITS.html#a4">01100</a> <font class="preprocessor">#define NIFTI_UNITS_SEC     8</font>
01101 <font class="preprocessor"></font>
<a name="l01102"></a><a class="code" href="group_NIFTI1_UNITS.html#a5">01102</a> <font class="preprocessor">#define NIFTI_UNITS_MSEC   16</font>
01103 <font class="preprocessor"></font>
<a name="l01104"></a><a class="code" href="group_NIFTI1_UNITS.html#a6">01104</a> <font class="preprocessor">#define NIFTI_UNITS_USEC   24</font>
01105 <font class="preprocessor"></font>
01106                                <font class="comment">/*** These units are for spectral data: ***/</font>
<a name="l01108"></a><a class="code" href="group_NIFTI1_UNITS.html#a7">01108</a> <font class="preprocessor">#define NIFTI_UNITS_HZ     32</font>
01109 <font class="preprocessor"></font>
<a name="l01110"></a><a class="code" href="group_NIFTI1_UNITS.html#a8">01110</a> <font class="preprocessor">#define NIFTI_UNITS_PPM    40</font>
01111 <font class="preprocessor"></font>
<a name="l01112"></a><a class="code" href="group_NIFTI1_UNITS.html#a9">01112</a> <font class="preprocessor">#define NIFTI_UNITS_RADS   48</font>
01113 <font class="preprocessor"></font><font class="comment">/* @} */</font>
01114 
01115 <font class="preprocessor">#undef  XYZT_TO_SPACE</font>
01116 <font class="preprocessor"></font><font class="preprocessor">#undef  XYZT_TO_TIME</font>
01117 <font class="preprocessor"></font><font class="preprocessor">#define XYZT_TO_SPACE(xyzt)       ( (xyzt) &amp; 0x07 )</font>
01118 <font class="preprocessor"></font><font class="preprocessor">#define XYZT_TO_TIME(xyzt)        ( (xyzt) &amp; 0x38 )</font>
01119 <font class="preprocessor"></font>
01120 <font class="preprocessor">#undef  SPACE_TIME_TO_XYZT</font>
01121 <font class="preprocessor"></font><font class="preprocessor">#define SPACE_TIME_TO_XYZT(ss,tt) (  (((char)(ss)) &amp; 0x07)   \</font>
01122 <font class="preprocessor">                                   | (((char)(tt)) &amp; 0x38) )</font>
01123 <font class="preprocessor"></font>
01124 <font class="comment">/*---------------------------------------------------------------------------*/</font>
01125 <font class="comment">/* MRI-SPECIFIC SPATIAL AND TEMPORAL INFORMATION:</font>
01126 <font class="comment">   ---------------------------------------------</font>
01127 <font class="comment">   A few fields are provided to store some extra information</font>
01128 <font class="comment">   that is sometimes important when storing the image data</font>
01129 <font class="comment">   from an FMRI time series experiment.  (After processing such</font>
01130 <font class="comment">   data into statistical images, these fields are not likely</font>
01131 <font class="comment">   to be useful.)</font>
01132 <font class="comment"></font>
01133 <font class="comment">  { freq_dim  } = These fields encode which spatial dimension (1,2, or 3)</font>
01134 <font class="comment">  { phase_dim } = corresponds to which acquisition dimension for MRI data.</font>
01135 <font class="comment">  { slice_dim } =</font>
01136 <font class="comment">    Examples:</font>
01137 <font class="comment">      Rectangular scan multi-slice EPI:</font>
01138 <font class="comment">        freq_dim = 1  phase_dim = 2  slice_dim = 3  (or some permutation)</font>
01139 <font class="comment">      Spiral scan multi-slice EPI:</font>
01140 <font class="comment">        freq_dim = phase_dim = 0  slice_dim = 3</font>
01141 <font class="comment">        since the concepts of frequency- and phase-encoding directions</font>
01142 <font class="comment">        don't apply to spiral scan</font>
01143 <font class="comment"></font>
01144 <font class="comment">    slice_duration = If this is positive, AND if slice_dim is nonzero,</font>
01145 <font class="comment">                     indicates the amount of time used to acquire 1 slice.</font>
01146 <font class="comment">                     slice_duration*dim[slice_dim] can be less than pixdim[4]</font>
01147 <font class="comment">                     with a clustered acquisition method, for example.</font>
01148 <font class="comment"></font>
01149 <font class="comment">    slice_code = If this is nonzero, AND if slice_dim is nonzero, AND</font>
01150 <font class="comment">                 if slice_duration is positive, indicates the timing</font>
01151 <font class="comment">                 pattern of the slice acquisition.  The following codes</font>
01152 <font class="comment">                 are defined:</font>
01153 <font class="comment">                   NIFTI_SLICE_SEQ_INC</font>
01154 <font class="comment">                   NIFTI_SLICE_SEQ_DEC</font>
01155 <font class="comment">                   NIFTI_SLICE_ALT_INC</font>
01156 <font class="comment">                   NIFTI_SLICE_ALT_DEC</font>
01157 <font class="comment">  { slice_start } = Indicates the start and end of the slice acquisition</font>
01158 <font class="comment">  { slice_end   } = pattern, when slice_code is nonzero.  These values</font>
01159 <font class="comment">                    are present to allow for the possible addition of</font>
01160 <font class="comment">                    "padded" slices at either end of the volume, which</font>
01161 <font class="comment">                    don't fit into the slice timing pattern.  If there</font>
01162 <font class="comment">                    are no padding slices, then slice_start=0 and</font>
01163 <font class="comment">                    slice_end=dim[slice_dim]-1 are the correct values.</font>
01164 <font class="comment">                    For these values to be meaningful, slice_start must</font>
01165 <font class="comment">                    be non-negative and slice_end must be greater than</font>
01166 <font class="comment">                    slice_start.</font>
01167 <font class="comment"></font>
01168 <font class="comment">  The following table indicates the slice timing pattern, relative to</font>
01169 <font class="comment">  time=0 for the first slice acquired, for some sample cases.  Here,</font>
01170 <font class="comment">  dim[slice_dim]=7 (there are 7 slices, labeled 0..6), slice_duration=0.1,</font>
01171 <font class="comment">  and slice_start=1, slice_end=5 (1 padded slice on each end).</font>
01172 <font class="comment"></font>
01173 <font class="comment">    slice</font>
01174 <font class="comment">    index   SEQ_INC SEQ_DEC ALT_INC ALT_DEC</font>
01175 <font class="comment">      6  --   n/a     n/a     n/a     n/a     n/a = not applicable</font>
01176 <font class="comment">      5  --   0.4     0.0     0.2     0.0           (slice time offset</font>
01177 <font class="comment">      4  --   0.3     0.1     0.4     0.3            doesn't apply to</font>
01178 <font class="comment">      3  --   0.2     0.2     0.1     0.1            slices outside range</font>
01179 <font class="comment">      2  --   0.1     0.3     0.3     0.4            slice_start..slice_end)</font>
01180 <font class="comment">      1  --   0.0     0.4     0.0     0.2</font>
01181 <font class="comment">      0  --   n/a     n/a     n/a     n/a</font>
01182 <font class="comment"></font>
01183 <font class="comment">  The fields freq_dim, phase_dim, slice_dim are all squished into the single</font>
01184 <font class="comment">  byte field dim_info (2 bits each, since the values for each field are</font>
01185 <font class="comment">  limited to the range 0..3).  This unpleasantness is due to lack of space</font>
01186 <font class="comment">  in the 348 byte allowance.</font>
01187 <font class="comment"></font>
01188 <font class="comment">  The macros DIM_INFO_TO_FREQ_DIM, DIM_INFO_TO_PHASE_DIM, and</font>
01189 <font class="comment">  DIM_INFO_TO_SLICE_DIM can be used to extract these values from the</font>
01190 <font class="comment">  dim_info byte.</font>
01191 <font class="comment"></font>
01192 <font class="comment">  The macro FPS_INTO_DIM_INFO can be used to put these 3 values</font>
01193 <font class="comment">  into the dim_info byte.</font>
01194 <font class="comment">-----------------------------------------------------------------------------*/</font>
01195 
01196 <font class="preprocessor">#undef  DIM_INFO_TO_FREQ_DIM</font>
01197 <font class="preprocessor"></font><font class="preprocessor">#undef  DIM_INFO_TO_PHASE_DIM</font>
01198 <font class="preprocessor"></font><font class="preprocessor">#undef  DIM_INFO_TO_SLICE_DIM</font>
01199 <font class="preprocessor"></font>
01200 <font class="preprocessor">#define DIM_INFO_TO_FREQ_DIM(di)   ( ((di)     ) &amp; 0x03 )</font>
01201 <font class="preprocessor"></font><font class="preprocessor">#define DIM_INFO_TO_PHASE_DIM(di)  ( ((di) &gt;&gt; 2) &amp; 0x03 )</font>
01202 <font class="preprocessor"></font><font class="preprocessor">#define DIM_INFO_TO_SLICE_DIM(di)  ( ((di) &gt;&gt; 4) &amp; 0x03 )</font>
01203 <font class="preprocessor"></font>
01204 <font class="preprocessor">#undef  FPS_INTO_DIM_INFO</font>
01205 <font class="preprocessor"></font><font class="preprocessor">#define FPS_INTO_DIM_INFO(fd,pd,sd) ( ( ( ((char)(fd)) &amp; 0x03)      ) |  \</font>
01206 <font class="preprocessor">                                      ( ( ((char)(pd)) &amp; 0x03) &lt;&lt; 2 ) |  \</font>
01207 <font class="preprocessor">                                      ( ( ((char)(sd)) &amp; 0x03) &lt;&lt; 4 )  )</font>
01208 <font class="preprocessor"></font>
01213 <font class="preprocessor">#define NIFTI_SLICE_UNKNOWN  0</font>
01214 <font class="preprocessor"></font><font class="preprocessor">#define NIFTI_SLICE_SEQ_INC  1</font>
01215 <font class="preprocessor"></font><font class="preprocessor">#define NIFTI_SLICE_SEQ_DEC  2</font>
01216 <font class="preprocessor"></font><font class="preprocessor">#define NIFTI_SLICE_ALT_INC  3</font>
01217 <font class="preprocessor"></font><font class="preprocessor">#define NIFTI_SLICE_ALT_DEC  4</font>
01218 <font class="preprocessor"></font><font class="comment">/* @} */</font>
01219 
01220 <font class="comment">/*---------------------------------------------------------------------------*/</font>
01221 <font class="comment">/* UNUSED FIELDS:</font>
01222 <font class="comment">   -------------</font>
01223 <font class="comment">   Some of the ANALYZE 7.5 fields marked as ++UNUSED++ may need to be set</font>
01224 <font class="comment">   to particular values for compatibility with other programs.  The issue</font>
01225 <font class="comment">   of interoperability of ANALYZE 7.5 files is a murky one -- not all</font>
01226 <font class="comment">   programs require exactly the same set of fields.  (Unobscuring this</font>
01227 <font class="comment">   murkiness is a principal motivation behind NIFTI-1.)</font>
01228 <font class="comment"></font>
01229 <font class="comment">   Some of the fields that may need to be set for other (non-NIFTI aware)</font>
01230 <font class="comment">   software to be happy are:</font>
01231 <font class="comment"></font>
01232 <font class="comment">     extents    dbh.h says this should be 16384</font>
01233 <font class="comment">     regular    dbh.h says this should be the character 'r'</font>
01234 <font class="comment">     glmin,   } dbh.h says these values should be the min and max voxel</font>
01235 <font class="comment">      glmax   }  values for the entire dataset</font>
01236 <font class="comment"></font>
01237 <font class="comment">   It is best to initialize ALL fields in the NIFTI-1 header to 0</font>
01238 <font class="comment">   (e.g., with calloc()), then fill in what is needed.</font>
01239 <font class="comment">-----------------------------------------------------------------------------*/</font>
01240 
01241 <font class="comment">/*---------------------------------------------------------------------------*/</font>
01242 <font class="comment">/* MISCELLANEOUS C MACROS</font>
01243 <font class="comment">-----------------------------------------------------------------------------*/</font>
01244 
01245 <font class="comment">/*.................*/</font>
<a name="l01249"></a><a class="code" href="nifti1_h.html#a105">01249</a> <font class="preprocessor">#define NIFTI_VERSION(h)                               \</font>
01250 <font class="preprocessor"> ( ( (h).magic[0]=='n' &amp;&amp; (h).magic[3]=='\0'    &amp;&amp;     \</font>
01251 <font class="preprocessor">     ( (h).magic[1]=='i' || (h).magic[1]=='+' ) &amp;&amp;     \</font>
01252 <font class="preprocessor">     ( (h).magic[2]&gt;='1' &amp;&amp; (h).magic[2]&lt;='9' )   )    \</font>
01253 <font class="preprocessor"> ? (h).magic[2]-'0' : 0 )</font>
01254 <font class="preprocessor"></font>
01255 <font class="comment">/*.................*/</font>
<a name="l01260"></a><a class="code" href="nifti1_h.html#a106">01260</a> <font class="preprocessor">#define NIFTI_ONEFILE(h) ( (h).magic[1] == '+' )</font>
01261 <font class="preprocessor"></font>
01262 <font class="comment">/*.................*/</font>
<a name="l01266"></a><a class="code" href="nifti1_h.html#a107">01266</a> <font class="preprocessor">#define NIFTI_NEEDS_SWAP(h) ( (h).dim[0] &lt; 0 || (h).dim[0] &gt; 7 )</font>
01267 <font class="preprocessor"></font>
01268 <font class="comment">/*.................*/</font>
<a name="l01272"></a><a class="code" href="nifti1_h.html#a108">01272</a> <font class="preprocessor">#define NIFTI_5TH_DIM(h) ( ((h).dim[0]&gt;4 &amp;&amp; (h).dim[5]&gt;1) ? (h).dim[5] : 0 )</font>
01273 <font class="preprocessor"></font>
01274 <font class="comment">/*****************************************************************************/</font>
01275 
01276 <font class="comment">/*=================*/</font>
01277 <font class="preprocessor">#ifdef  __cplusplus</font>
01278 <font class="preprocessor"></font>}
01279 <font class="preprocessor">#endif</font>
01280 <font class="preprocessor"></font><font class="comment">/*=================*/</font>
01281 
01282 <font class="preprocessor">#endif </font><font class="comment">/* _NIFTI_HEADER_ */</font>
</div></pre><hr><address><small>Generated at Mon Dec 13 17:43:44 2004 for nifti1_io by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.4 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
